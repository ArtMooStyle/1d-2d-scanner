/*
 *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
*****************************************************************************/
var aa=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};function ba(a,b){function c(){this.constructor=a}aa(a,b);a.prototype=null===b?Object.create(b):(c.prototype=b.prototype,new c)}
var ca=function(a){function b(b){var c=this.constructor;b=a.call(this,b)||this;Object.defineProperty(b,"name",{value:c.name,enumerable:!1});c=c.prototype;var e=Object.setPrototypeOf;e?e(b,c):b.__proto__=c;c=void 0;void 0===c&&(c=b.constructor);(e=Error.captureStackTrace)&&e(b,c);return b}ba(b,a);return b}(Error);class da extends ca{constructor(a=void 0){super(a);this.message=a}}class ea extends da{}class k extends da{}
class ha{constructor(a){this.binarizer=a;if(null===a)throw new k("Binarizer must be non-null.");}getWidth(){return this.binarizer.getWidth()}getHeight(){return this.binarizer.getHeight()}getBlackRow(a,b){return this.binarizer.getBlackRow(a,b)}getBlackMatrix(){if(null===this.matrix||void 0===this.matrix)this.matrix=this.binarizer.getBlackMatrix();return this.matrix}isCropSupported(){return this.binarizer.getLuminanceSource().isCropSupported()}crop(a,b,c,d){a=this.binarizer.getLuminanceSource().crop(a,
b,c,d);return new ha(this.binarizer.createBinarizer(a))}isRotateSupported(){return this.binarizer.getLuminanceSource().isRotateSupported()}rotateCounterClockwise(){let a=this.binarizer.getLuminanceSource().rotateCounterClockwise();return new ha(this.binarizer.createBinarizer(a))}rotateCounterClockwise45(){let a=this.binarizer.getLuminanceSource().rotateCounterClockwise45();return new ha(this.binarizer.createBinarizer(a))}toString(){try{return this.getBlackMatrix().toString()}catch(a){return""}}}
class ia extends da{}class ja{constructor(a){this.source=a}getLuminanceSource(){return this.source}getWidth(){return this.source.getWidth()}getHeight(){return this.source.getHeight()}}class ka{static arraycopy(a,b,c,d,e){for(;e--;)c[d++]=a[b++]}static currentTimeMillis(){return Date.now()}}
class la{static numberOfTrailingZeros(a){let b;if(0===a)return 32;let c=31;b=a<<16;0!==b&&(c-=16,a=b);b=a<<8;0!==b&&(c-=8,a=b);b=a<<4;0!==b&&(c-=4,a=b);b=a<<2;0!==b&&(c-=2,a=b);return c-(a<<1>>>31)}static numberOfLeadingZeros(a){if(0===a)return 32;let b=1;0===a>>>16&&(b+=16,a<<=16);0===a>>>24&&(b+=8,a<<=8);0===a>>>28&&(b+=4,a<<=4);0===a>>>30&&(b+=2,a<<=2);return b-(a>>>31)}static toHexString(a){return a.toString(16)}static bitCount(a){a-=a>>>1&1431655765;a=(a&858993459)+(a>>>2&858993459);a=a+(a>>>
4)&252645135;a+=a>>>8;return a+(a>>>16)&63}}la.MIN_VALUE_32_BITS=-2147483648;
class ma{static equals(a,b){if(!(a&&b&&a.length&&b.length)||a.length!==b.length)return!1;for(let c=0,d=a.length;c<d;c++)if(a[c]!==b[c])return!1;return!0}static hashCode(a){if(null===a)return 0;let b=1;for(let c of a)b=31*b+c;return b}static fillUint8Array(a,b){for(let c=0;c!==a.length;c++)a[c]=b}static copyOf(a,b){let c=new Int32Array(b);ka.arraycopy(a,0,c,0,Math.min(a.length,b));return c}static binarySearch(a,b,c){void 0===c&&(c=ma.numberComparator);let d=0,e=a.length-1;for(;d<=e;){let f=e+d>>1,
g=c(b,a[f]);if(0<g)d=f+1;else if(0>g)e=f-1;else return f}return-d-1}static numberComparator(a,b){return a-b}}
class na{constructor(a,b){void 0===a?(this.size=0,this.bits=new Int32Array(1)):(this.size=a,this.bits=void 0===b||null===b?na.makeArray(a):b)}getSize(){return this.size}getSizeInBytes(){return Math.floor((this.size+7)/8)}ensureCapacity(a){a>32*this.bits.length&&(a=na.makeArray(a),ka.arraycopy(this.bits,0,a,0,this.bits.length),this.bits=a)}get(a){return 0!==(this.bits[Math.floor(a/32)]&1<<(a&31))}set(a){this.bits[Math.floor(a/32)]|=1<<(a&31)}flip(a){this.bits[Math.floor(a/32)]^=1<<(a&31)}getNextSet(a){let b=
this.size;if(a>=b)return b;var c=this.bits;let d=Math.floor(a/32),e=c[d];e&=~((1<<(a&31))-1);for(a=c.length;0===e;){if(++d===a)return b;e=c[d]}c=32*d+la.numberOfTrailingZeros(e);return c>b?b:c}getNextUnset(a){let b=this.size;if(a>=b)return b;var c=this.bits;let d=Math.floor(a/32),e=~c[d];e&=~((1<<(a&31))-1);for(a=c.length;0===e;){if(++d===a)return b;e=~c[d]}c=32*d+la.numberOfTrailingZeros(e);return c>b?b:c}setBulk(a,b){this.bits[Math.floor(a/32)]=b}setRange(a,b){if(b<a||0>a||b>this.size)throw new k;
if(b!==a){b--;var c=Math.floor(a/32),d=Math.floor(b/32),e=this.bits;for(let f=c;f<=d;f++)e[f]|=(2<<(f<d?31:b&31))-(1<<(f>c?0:a&31))}}clear(){let a=this.bits.length,b=this.bits;for(let c=0;c<a;c++)b[c]=0}isRange(a,b,c){if(b<a||0>a||b>this.size)throw new k;if(b===a)return!0;b--;let d=Math.floor(a/32),e=Math.floor(b/32),f=this.bits;for(let g=d;g<=e;g++){let h=(2<<(g<e?31:b&31))-(1<<(g>d?0:a&31))&4294967295;if((f[g]&h)!==(c?h:0))return!1}return!0}appendBit(a){this.ensureCapacity(this.size+1);a&&(this.bits[Math.floor(this.size/
32)]|=1<<(this.size&31));this.size++}appendBits(a,b){if(0>b||32<b)throw new k("Num bits must be between 0 and 32");for(this.ensureCapacity(this.size+b);0<b;b--)this.appendBit(1===(a>>b-1&1))}appendBitArray(a){let b=a.size;this.ensureCapacity(this.size+b);for(let c=0;c<b;c++)this.appendBit(a.get(c))}xor(a){if(this.size!==a.size)throw new k("Sizes don't match");let b=this.bits;for(let c=0,d=b.length;c<d;c++)b[c]^=a.bits[c]}toBytes(a,b,c,d){for(let e=0;e<d;e++){let d=0;for(let b=0;8>b;b++)this.get(a)&&
(d|=1<<7-b),a++;b[c+e]=d}}getBitArray(){return this.bits}reverse(){let a=new Int32Array(this.bits.length);var b=Math.floor((this.size-1)/32);let c=b+1;var d=this.bits;for(var e=0;e<c;e++){var f=d[e];f=f>>1&1431655765|(f&1431655765)<<1;f=f>>2&858993459|(f&858993459)<<2;f=f>>4&252645135|(f&252645135)<<4;f=f>>8&16711935|(f&16711935)<<8;f=f>>16&65535|(f&65535)<<16;a[b-e]=f}if(this.size!==32*c){b=32*c-this.size;d=a[0]>>>b;for(e=1;e<c;e++)f=a[e],d|=f<<32-b,a[e-1]=d,d=f>>>b;a[c-1]=d}this.bits=a}static makeArray(a){return new Int32Array(Math.floor((a+
31)/32))}equals(a){return a instanceof na?this.size===a.size&&ma.equals(this.bits,a.bits):!1}hashCode(){return 31*this.size+ma.hashCode(this.bits)}toString(){let a="";for(let b=0,c=this.size;b<c;b++)0===(b&7)&&(a+=" "),a+=this.get(b)?"X":".";return a}clone(){return new na(this.size,this.bits.slice())}}
class oa{constructor(a=""){this.value=a}append(a){this.value="string"===typeof a?this.value+a.toString():this.value+String.fromCharCode(a);return this}length(){return this.value.length}charAt(a){return this.value.charAt(a)}deleteCharAt(a){this.value=this.value.substr(0,a)+this.value.substring(a+1)}setCharAt(a,b){this.value=this.value.substr(0,a)+b+this.value.substr(a+1)}toString(){return this.value}insert(a,b){this.value=this.value.substr(0,a)+b+this.value.substr(a+b.length)}}
class pa{constructor(a,b,c,d){this.width=a;this.height=b;this.rowSize=c;this.bits=d;if(void 0===b||null===b)b=a;this.height=b;if(1>a||1>b)throw new k("Both dimensions must be greater than 0");if(void 0===c||null===c)c=Math.floor((a+31)/32);this.rowSize=c;if(void 0===d||null===d)this.bits=new Int32Array(this.rowSize*this.height)}static parseFromBooleanArray(a){let b=a.length,c=a[0].length,d=new pa(c,b);for(let e=0;e<b;e++){let b=a[e];for(let a=0;a<c;a++)b[a]&&d.set(a,e)}return d}static parseFromString(a,
b,c){if(null===a)throw new k("stringRepresentation cannot be null");let d=Array(a.length),e=0,f=0,g=-1,h=0,l=0;for(;l<a.length;)if("\n"===a.charAt(l)||"\r"===a.charAt(l)){if(e>f){if(-1===g)g=e-f;else if(e-f!==g)throw new k("row lengths do not match");f=e;h++}l++}else if(a.substring(l,l+b.length)===b)l+=b.length,d[e]=!0,e++;else if(a.substring(l,l+c.length)===c)l+=c.length,d[e]=!1,e++;else throw new k("illegal character encountered: "+a.substring(l));if(e>f){if(-1===g)g=e-f;else if(e-f!==g)throw new k("row lengths do not match");
h++}a=new pa(g,h);for(b=0;b<e;b++)d[b]&&a.set(Math.floor(b%g),Math.floor(b/g));return a}get(a,b){return 0!==(this.bits[b*this.rowSize+Math.floor(a/32)]>>>(a&31)&1)}set(a,b){this.bits[b*this.rowSize+Math.floor(a/32)]|=1<<(a&31)&4294967295}unset(a,b){this.bits[b*this.rowSize+Math.floor(a/32)]&=~(1<<(a&31)&4294967295)}flip(a,b){this.bits[b*this.rowSize+Math.floor(a/32)]^=1<<(a&31)&4294967295}xor(a){if(this.width!==a.getWidth()||this.height!==a.getHeight()||this.rowSize!==a.getRowSize())throw new k("input matrix dimensions do not match");
let b=new na(Math.floor(this.width/32)+1),c=this.rowSize,d=this.bits;for(let e=0,f=this.height;e<f;e++){let f=e*c,h=a.getRow(e,b).getBitArray();for(let a=0;a<c;a++)d[f+a]^=h[a]}}clear(){let a=this.bits,b=a.length;for(let c=0;c<b;c++)a[c]=0}setRegion(a,b,c,d){if(0>b||0>a)throw new k("Left and top must be nonnegative");if(1>d||1>c)throw new k("Height and width must be at least 1");c=a+c;d=b+d;if(d>this.height||c>this.width)throw new k("The region must fit inside the matrix");let e=this.rowSize,f=this.bits;
for(;b<d;b++){let d=b*e;for(let b=a;b<c;b++)f[d+Math.floor(b/32)]|=1<<(b&31)&4294967295}}getRow(a,b){null===b||void 0===b||b.getSize()<this.width?b=new na(this.width):b.clear();let c=this.rowSize,d=this.bits;a*=c;for(let e=0;e<c;e++)b.setBulk(32*e,d[a+e]);return b}setRow(a,b){ka.arraycopy(b.getBitArray(),0,this.bits,a*this.rowSize,this.rowSize)}rotate180(){var a=this.getWidth();let b=this.getHeight(),c=new na(a);a=new na(a);for(let d=0,e=Math.floor((b+1)/2);d<e;d++)c=this.getRow(d,c),a=this.getRow(b-
1-d,a),c.reverse(),a.reverse(),this.setRow(d,a),this.setRow(b-1-d,c)}getEnclosingRectangle(){let a=this.height,b=this.rowSize,c=this.bits,d=this.width,e=a,f=-1,g=-1;for(let l=0;l<a;l++)for(let a=0;a<b;a++){let r=c[l*b+a];if(0!==r){l<e&&(e=l);l>g&&(g=l);if(32*a<d){for(var h=0;0===(r<<31-h&4294967295);)h++;32*a+h<d&&(d=32*a+h)}if(32*a+31>f){for(h=31;0===r>>>h;)h--;32*a+h>f&&(f=32*a+h)}}}return f<d||g<e?null:Int32Array.from([d,e,f-d+1,g-e+1])}getTopLeftOnBit(){let a=this.rowSize;var b=this.bits;let c=
0;for(;c<b.length&&0===b[c];)c++;if(c===b.length)return null;b=b[c];let d=0;for(;0===(b<<31-d&4294967295);)d++;return Int32Array.from([c%a*32+d,c/a])}getBottomRightOnBit(){for(var a=this.rowSize,b=this.bits,c=b.length-1;0<=c&&0===b[c];)c--;if(0>c)return null;let d=Math.floor(c/a);a=32*Math.floor(c%a);b=b[c];for(c=31;0===b>>>c;)c--;return Int32Array.from([a+c,d])}getWidth(){return this.width}getHeight(){return this.height}getRowSize(){return this.rowSize}equals(a){return a instanceof pa?this.width===
a.width&&this.height===a.height&&this.rowSize===a.rowSize&&ma.equals(this.bits,a.bits):!1}hashCode(){let a=this.width;a=31*a+this.width;a=31*a+this.height;a=31*a+this.rowSize;return a=31*a+ma.hashCode(this.bits)}toString(a="x",b=" ",c="\n"){return this.buildToString(a,b,c)}buildToString(a,b,c){let d=new oa;d.append(c);for(let e=0,f=this.height;e<f;e++){for(let c=0,f=this.width;c<f;c++)d.append(this.get(c,e)?a:b);d.append(c)}return d.toString()}clone(){return new pa(this.width,this.height,this.rowSize,
this.bits.slice())}}class m extends da{}
class ra extends ja{constructor(a){super(a);this.luminances=ra.EMPTY;this.buckets=new Int32Array(ra.LUMINANCE_BUCKETS)}getBlackRow(a,b){var c=this.getLuminanceSource();let d=c.getWidth();void 0===b||null===b||b.getSize()<d?b=new na(d):b.clear();this.initArrays(d);a=c.getRow(a,this.luminances);c=this.buckets;for(var e=0;e<d;e++)c[(a[e]&255)>>ra.LUMINANCE_SHIFT]++;c=ra.estimateBlackPoint(c);if(3>d)for(e=0;e<d;e++)(a[e]&255)<c&&b.set(e);else{e=a[0]&255;let f=a[1]&255;for(let g=1;g<d-1;g++){let d=a[g+
1]&255;(4*f-e-d)/2<c&&b.set(g);e=f;f=d}}return b}getBlackMatrix(){var a=this.getLuminanceSource();let b=a.getWidth(),c=a.getHeight(),d=new pa(b,c);this.initArrays(b);var e=this.buckets;for(var f=1;5>f;f++){var g=a.getRow(c*f/5,this.luminances),h=Math.floor(4*b/5);for(let a=Math.floor(b/5);a<h;a++)e[(g[a]&255)>>ra.LUMINANCE_SHIFT]++}e=ra.estimateBlackPoint(e);a=a.getMatrix();for(f=0;f<c;f++)for(g=f*b,h=0;h<b;h++)(a[g+h]&255)<e&&d.set(h,f);return d}createBinarizer(a){return new ra(a)}initArrays(a){this.luminances.length<
a&&(this.luminances=new Uint8ClampedArray(a));a=this.buckets;for(let b=0;b<ra.LUMINANCE_BUCKETS;b++)a[b]=0}static estimateBlackPoint(a){var b=a.length;let c=0,d=0;var e=0;for(var f=0;f<b;f++)a[f]>e&&(d=f,e=a[f]),a[f]>c&&(c=a[f]);f=e=0;for(var g=0;g<b;g++){var h=g-d;h*=a[g]*h;h>f&&(e=g,f=h)}d>e&&(f=d,d=e,e=f);if(e-d<=b/16)throw new m;b=e-1;f=-1;for(g=e-1;g>d;g--)h=g-d,h=h*h*(e-g)*(c-a[g]),h>f&&(b=g,f=h);return b<<ra.LUMINANCE_SHIFT}}ra.LUMINANCE_BITS=5;ra.LUMINANCE_SHIFT=8-ra.LUMINANCE_BITS;
ra.LUMINANCE_BUCKETS=1<<ra.LUMINANCE_BITS;ra.EMPTY=Uint8ClampedArray.from([0]);
class n extends ra{constructor(a){super(a);this.matrix=null}getBlackMatrix(){if(null!==this.matrix)return this.matrix;var a=this.getLuminanceSource();let b=a.getWidth(),c=a.getHeight();if(b>=n.MINIMUM_DIMENSION&&c>=n.MINIMUM_DIMENSION){a=a.getMatrix();let d=b>>n.BLOCK_SIZE_POWER;0!==(b&n.BLOCK_SIZE_MASK)&&d++;let e=c>>n.BLOCK_SIZE_POWER;0!==(c&n.BLOCK_SIZE_MASK)&&e++;let f=n.calculateBlackPoints(a,d,e,b,c),g=new pa(b,c);n.calculateThresholdForBlock(a,d,e,b,c,f,g);this.matrix=g}else this.matrix=super.getBlackMatrix();
return this.matrix}createBinarizer(a){return new n(a)}static calculateThresholdForBlock(a,b,c,d,e,f,g){e-=n.BLOCK_SIZE;let h=d-n.BLOCK_SIZE;for(let l=0;l<c;l++){let r=l<<n.BLOCK_SIZE_POWER;r>e&&(r=e);let u=n.cap(l,2,c-3);for(let c=0;c<b;c++){let e=c<<n.BLOCK_SIZE_POWER;e>h&&(e=h);let l=n.cap(c,2,b-3),v=0;for(let a=-2;2>=a;a++){let b=f[u+a];v+=b[l-2]+b[l-1]+b[l]+b[l+1]+b[l+2]}n.thresholdBlock(a,e,r,v/25,d,g)}}}static cap(a,b,c){return a<b?b:a>c?c:a}static thresholdBlock(a,b,c,d,e,f){for(let g=0,h=
c*e+b;g<n.BLOCK_SIZE;g++,h+=e)for(let e=0;e<n.BLOCK_SIZE;e++)(a[h+e]&255)<=d&&f.set(b+e,c+g)}static calculateBlackPoints(a,b,c,d,e){e-=n.BLOCK_SIZE;let f=d-n.BLOCK_SIZE,g=Array(c);for(let u=0;u<c;u++){g[u]=new Int32Array(b);let c=u<<n.BLOCK_SIZE_POWER;c>e&&(c=e);for(let e=0;e<b;e++){var h=e<<n.BLOCK_SIZE_POWER;h>f&&(h=f);var l=0;let b=255;var r=0;for(let e=0,f=c*d+h;e<n.BLOCK_SIZE;e++,f+=d){for(h=0;h<n.BLOCK_SIZE;h++){let c=a[f+h]&255;l+=c;c<b&&(b=c);c>r&&(r=c)}if(r-b>n.MIN_DYNAMIC_RANGE)for(e++,
f+=d;e<n.BLOCK_SIZE;e++,f+=d)for(h=0;h<n.BLOCK_SIZE;h++)l+=a[f+h]&255}l>>=2*n.BLOCK_SIZE_POWER;r-b<=n.MIN_DYNAMIC_RANGE&&(l=b/2,0<u&&0<e&&(r=(g[u-1][e]+2*g[u][e-1]+g[u-1][e-1])/4,b<r&&(l=r)));g[u][e]=l}}return g}}n.BLOCK_SIZE_POWER=3;n.BLOCK_SIZE=1<<n.BLOCK_SIZE_POWER;n.BLOCK_SIZE_MASK=n.BLOCK_SIZE-1;n.MINIMUM_DIMENSION=5*n.BLOCK_SIZE;n.MIN_DYNAMIC_RANGE=24;class p extends da{}class sa extends da{}
class ta{constructor(a,b){this.width=a;this.height=b}getWidth(){return this.width}getHeight(){return this.height}isCropSupported(){return!1}crop(){throw new sa("This luminance source does not support cropping.");}isRotateSupported(){return!1}rotateCounterClockwise(){throw new sa("This luminance source does not support rotation by 90 degrees.");}rotateCounterClockwise45(){throw new sa("This luminance source does not support rotation by 45 degrees.");}toString(){let a=new Uint8ClampedArray(this.width),
b=new oa;for(let c=0;c<this.height;c++){let d=this.getRow(c,a);for(let a=0;a<this.width;a++){let c=d[a]&255;b.append(64>c?"#":128>c?"+":192>c?".":" ")}b.append("\n")}return b.toString()}}
class ua extends ta{constructor(a){super(a.getWidth(),a.getHeight());this.delegate=a}getRow(a,b){a=this.delegate.getRow(a,b);b=this.getWidth();for(let c=0;c<b;c++)a[c]=255-(a[c]&255);return a}getMatrix(){let a=this.delegate.getMatrix(),b=this.getWidth()*this.getHeight(),c=new Uint8ClampedArray(b);for(let d=0;d<b;d++)c[d]=255-(a[d]&255);return c}isCropSupported(){return this.delegate.isCropSupported()}crop(a,b,c,d){return new ua(this.delegate.crop(a,b,c,d))}isRotateSupported(){return this.delegate.isRotateSupported()}invert(){return this.delegate}rotateCounterClockwise(){return new ua(this.delegate.rotateCounterClockwise())}rotateCounterClockwise45(){return new ua(this.delegate.rotateCounterClockwise45())}}
class va extends ta{constructor(a){super(a.width,a.height);this.canvas=a;this.tempCanvasElement=null;this.buffer=va.makeBufferFromCanvasImageData(a)}static makeBufferFromCanvasImageData(a){let b=a.getContext("2d").getImageData(0,0,a.width,a.height);return va.toGrayscaleBuffer(b.data,a.width,a.height)}static toGrayscaleBuffer(a,b,c){b=new Uint8ClampedArray(b*c);for(let c=0,e=0,f=a.length;c<f;c+=4,e++)b[e]=0===a[c+3]?255:306*a[c]+601*a[c+1]+117*a[c+2]+512>>10;return b}getRow(a,b){if(0>a||a>=this.getHeight())throw new k("Requested row is outside the image: "+
a);let c=this.getWidth();a*=c;null===b?b=this.buffer.slice(a,a+c):(b.length<c&&(b=new Uint8ClampedArray(c)),b.set(this.buffer.slice(a,a+c)));return b}getMatrix(){return this.buffer}isCropSupported(){return!0}crop(a,b,c,d){this.crop(a,b,c,d);return this}isRotateSupported(){return!0}rotateCounterClockwise(){this.rotate(-90);return this}rotateCounterClockwise45(){this.rotate(-45);return this}getTempCanvasElement(){if(null===this.tempCanvasElement){let a=this.canvas.ownerDocument.createElement("canvas");
a.width=this.canvas.width;a.height=this.canvas.height;this.tempCanvasElement=a}return this.tempCanvasElement}rotate(a){let b=this.getTempCanvasElement(),c=b.getContext("2d");a*=va.DEGREE_TO_RADIANS;let d=this.canvas.width,e=this.canvas.height,f=Math.ceil(Math.abs(Math.cos(a))*d+Math.abs(Math.sin(a))*e),g=Math.ceil(Math.abs(Math.sin(a))*d+Math.abs(Math.cos(a))*e);b.width=f;b.height=g;c.translate(f/2,g/2);c.rotate(a);c.drawImage(this.canvas,d/-2,e/-2);this.buffer=va.makeBufferFromCanvasImageData(b);
return this}invert(){return new ua(this)}}va.DEGREE_TO_RADIANS=Math.PI/180;class wa{constructor(a,b,c){this.deviceId=a;this.label=b;this.kind="videoinput";this.groupId=c||void 0}toJSON(){return{kind:this.kind,groupId:this.groupId,deviceId:this.deviceId,label:this.label}}}
function xa(a,b,c,d){return new (c||(c=Promise))(function(e,f){function g(a){try{l(d.next(a))}catch(u){f(u)}}function h(a){try{l(d["throw"](a))}catch(u){f(u)}}function l(a){a.done?e(a.value):(new c(function(b){b(a.value)})).then(g,h)}l((d=d.apply(a,b||[])).next())})}
class za{constructor(a,b=500,c){this.reader=a;this.timeBetweenScansMillis=b;this._hints=c;this._stopAsyncDecode=this._stopContinuousDecode=!1;this._timeBetweenDecodingAttempts=0}get hasNavigator(){return"undefined"!==typeof navigator}get isMediaDevicesSuported(){return this.hasNavigator&&!!navigator.mediaDevices}get canEnumerateDevices(){return!(!this.isMediaDevicesSuported||!navigator.mediaDevices.enumerateDevices)}get timeBetweenDecodingAttempts(){return this._timeBetweenDecodingAttempts}set timeBetweenDecodingAttempts(a){this._timeBetweenDecodingAttempts=
0>a?0:a}set hints(a){this._hints=a||null}get hints(){return this._hints}listVideoInputDevices(){return xa(this,void 0,void 0,function*(){if(!this.hasNavigator)throw Error("Can't enumerate devices, navigator is not present.");if(!this.canEnumerateDevices)throw Error("Can't enumerate devices, method not supported.");var a=yield navigator.mediaDevices.enumerateDevices();let b=[];for(let c of a)a="video"===c.kind?"videoinput":c.kind,"videoinput"===a&&b.push({deviceId:c.deviceId||c.id,label:c.label||`Video device ${b.length+
1}`,kind:a,groupId:c.groupId});return b})}getVideoInputDevices(){return xa(this,void 0,void 0,function*(){return(yield this.listVideoInputDevices()).map((a)=>new wa(a.deviceId,a.label))})}findDeviceById(a){return xa(this,void 0,void 0,function*(){let b=yield this.listVideoInputDevices();return b?b.find((b)=>b.deviceId===a):null})}decodeFromInputVideoDevice(a,b){return xa(this,void 0,void 0,function*(){return yield this.decodeOnceFromVideoDevice(a,b)})}decodeOnceFromVideoDevice(a,b){return xa(this,
void 0,void 0,function*(){this.reset();return yield this.decodeOnceFromConstraints({video:a?{deviceId:{exact:a}}:{facingMode:"environment"}},b)})}decodeOnceFromConstraints(a,b){return xa(this,void 0,void 0,function*(){let c=yield navigator.mediaDevices.getUserMedia(a);return yield this.decodeOnceFromStream(c,b)})}decodeOnceFromStream(a,b){return xa(this,void 0,void 0,function*(){this.reset();let c=yield this.attachStreamToVideo(a,b);return yield this.decodeOnce(c)})}decodeFromInputVideoDeviceContinuously(a,
b,c){return xa(this,void 0,void 0,function*(){return yield this.decodeFromVideoDevice(a,b,c)})}decodeFromVideoDevice(a,b,c){return xa(this,void 0,void 0,function*(){return yield this.decodeFromConstraints({video:a?{deviceId:{exact:a}}:{facingMode:"environment"}},b,c)})}decodeFromConstraints(a,b,c){return xa(this,void 0,void 0,function*(){let d=yield navigator.mediaDevices.getUserMedia(a);return yield this.decodeFromStream(d,b,c)})}decodeFromStream(a,b,c){return xa(this,void 0,void 0,function*(){this.reset();
let d=yield this.attachStreamToVideo(a,b);return yield this.decodeContinuously(d,c)})}stopAsyncDecode(){this._stopAsyncDecode=!0}stopContinuousDecode(){this._stopContinuousDecode=!0}attachStreamToVideo(a,b){return xa(this,void 0,void 0,function*(){let c=this.prepareVideoElement(b);this.addVideoSource(c,a);this.videoElement=c;this.stream=a;yield this.playVideoOnLoadAsync(c);return c})}playVideoOnLoadAsync(a){return new Promise((b)=>this.playVideoOnLoad(a,()=>b()))}playVideoOnLoad(a,b){this.videoEndedListener=
()=>this.stopStreams();this.videoCanPlayListener=()=>this.tryPlayVideo(a);a.addEventListener("ended",this.videoEndedListener);a.addEventListener("canplay",this.videoCanPlayListener);a.addEventListener("playing",b);this.tryPlayVideo(a)}isVideoPlaying(a){return 0<a.currentTime&&!a.paused&&!a.ended&&2<a.readyState}tryPlayVideo(a){return xa(this,void 0,void 0,function*(){if(this.isVideoPlaying(a))console.warn("Trying to play video that is already playing.");else try{yield a.play()}catch(b){console.warn("It was not possible to play the video.")}})}getMediaElement(a,
b){let c=document.getElementById(a);if(!c)throw new ea(`element with id '${a}' not found`);if(c.nodeName.toLowerCase()!==b.toLowerCase())throw new ea(`element with id '${a}' must be an ${b} element`);return c}decodeFromImage(a,b){if(!a&&!b)throw new ea("either imageElement with a src set or an url must be provided");return b&&!a?this.decodeFromImageUrl(b):this.decodeFromImageElement(a)}decodeFromVideo(a,b){if(!a&&!b)throw new ea("Either an element with a src set or an URL must be provided");return b&&
!a?this.decodeFromVideoUrl(b):this.decodeFromVideoElement(a)}decodeFromVideoContinuously(a,b,c){if(void 0===a&&void 0===b)throw new ea("Either an element with a src set or an URL must be provided");return b&&!a?this.decodeFromVideoUrlContinuously(b,c):this.decodeFromVideoElementContinuously(a,c)}decodeFromImageElement(a){if(!a)throw new ea("An image element must be provided.");this.reset();this.imageElement=a=this.prepareImageElement(a);return this.isImageLoaded(a)?this.decodeOnce(a,!1,!0):this._decodeOnLoadImage(a)}decodeFromVideoElement(a){a=
this._decodeFromVideoElementSetup(a);return this._decodeOnLoadVideo(a)}decodeFromVideoElementContinuously(a,b){a=this._decodeFromVideoElementSetup(a);return this._decodeOnLoadVideoContinuously(a,b)}_decodeFromVideoElementSetup(a){if(!a)throw new ea("A video element must be provided.");this.reset();return this.videoElement=a=this.prepareVideoElement(a)}decodeFromImageUrl(a){if(!a)throw new ea("An URL must be provided.");this.reset();let b=this.prepareImageElement();this.imageElement=b;let c=this._decodeOnLoadImage(b);
b.src=a;return c}decodeFromVideoUrl(a){if(!a)throw new ea("An URL must be provided.");this.reset();let b=this.prepareVideoElement(),c=this.decodeFromVideoElement(b);b.src=a;return c}decodeFromVideoUrlContinuously(a,b){if(!a)throw new ea("An URL must be provided.");this.reset();let c=this.prepareVideoElement();b=this.decodeFromVideoElementContinuously(c,b);c.src=a;return b}_decodeOnLoadImage(a){return new Promise((b,c)=>{this.imageLoadedListener=()=>this.decodeOnce(a,!1,!0).then(b,c);a.addEventListener("load",
this.imageLoadedListener)})}_decodeOnLoadVideo(a){return xa(this,void 0,void 0,function*(){yield this.playVideoOnLoadAsync(a);return yield this.decodeOnce(a)})}_decodeOnLoadVideoContinuously(a,b){return xa(this,void 0,void 0,function*(){yield this.playVideoOnLoadAsync(a);this.decodeContinuously(a,b)})}isImageLoaded(a){return a.complete&&0!==a.naturalWidth?!0:!1}prepareImageElement(a){let b;"undefined"===typeof a&&(b=document.createElement("img"),b.width=200,b.height=200);"string"===typeof a&&(b=this.getMediaElement(a,
"img"));a instanceof HTMLImageElement&&(b=a);return b}prepareVideoElement(a){let b;a||"undefined"===typeof document||(b=document.createElement("video"),b.width=200,b.height=200);"string"===typeof a&&(b=this.getMediaElement(a,"video"));a instanceof HTMLVideoElement&&(b=a);b.setAttribute("autoplay","true");b.setAttribute("muted","true");b.setAttribute("playsinline","true");return b}decodeOnce(a,b=!0,c=!0){this._stopAsyncDecode=!1;let d=(e,f)=>{if(this._stopAsyncDecode)f(new m("Video stream has ended before any code could be detected.")),
this._stopAsyncDecode=void 0;else try{var g=this.decode(a);e(g)}catch(h){g=(h instanceof ia||h instanceof p)&&c;if(b&&h instanceof m||g)return setTimeout(()=>d(e,f),this._timeBetweenDecodingAttempts);f(h)}};return new Promise((a,b)=>d(a,b))}decodeContinuously(a,b){this._stopContinuousDecode=!1;let c=()=>{if(this._stopContinuousDecode)this._stopContinuousDecode=void 0;else try{var d=this.decode(a);b(d,null);setTimeout(()=>c(),this.timeBetweenScansMillis)}catch(e){b(null,e),d=e instanceof m,(e instanceof
ia||e instanceof p||d)&&setTimeout(()=>c(),this._timeBetweenDecodingAttempts)}};c()}decode(a){a=this.createBinaryBitmap(a);return this.decodeBitmap(a)}createBinaryBitmap(a){let b=this.getCaptureCanvasContext(a);this.drawImageOnCanvas(b,a);a=this.getCaptureCanvas(a);a=new va(a);a=new n(a);return new ha(a)}getCaptureCanvasContext(a){this.captureCanvasContext||(this.captureCanvasContext=this.getCaptureCanvas(a).getContext("2d"));return this.captureCanvasContext}getCaptureCanvas(a){this.captureCanvas||
(this.captureCanvas=this.createCaptureCanvas(a));return this.captureCanvas}drawImageOnCanvas(a,b){a.drawImage(b,0,0)}decodeBitmap(a){return this.reader.decode(a,this._hints)}createCaptureCanvas(a){if("undefined"===typeof document)return this._destroyCaptureCanvas(),null;let b=document.createElement("canvas"),c,d;"undefined"!==typeof a&&(a instanceof HTMLVideoElement?(c=a.videoWidth,d=a.videoHeight):a instanceof HTMLImageElement&&(c=a.naturalWidth||a.width,d=a.naturalHeight||a.height));b.style.width=
c+"px";b.style.height=d+"px";b.width=c;b.height=d;return b}stopStreams(){this.stream&&(this.stream.getVideoTracks().forEach((a)=>a.stop()),this.stream=void 0);!1===this._stopAsyncDecode&&this.stopAsyncDecode();!1===this._stopContinuousDecode&&this.stopContinuousDecode()}reset(){this.stopStreams();this._destroyVideoElement();this._destroyImageElement();this._destroyCaptureCanvas()}_destroyVideoElement(){this.videoElement&&("undefined"!==typeof this.videoEndedListener&&this.videoElement.removeEventListener("ended",
this.videoEndedListener),"undefined"!==typeof this.videoPlayingEventListener&&this.videoElement.removeEventListener("playing",this.videoPlayingEventListener),"undefined"!==typeof this.videoCanPlayListener&&this.videoElement.removeEventListener("loadedmetadata",this.videoCanPlayListener),this.cleanVideoSource(this.videoElement),this.videoElement=void 0)}_destroyImageElement(){this.imageElement&&(void 0!==this.imageLoadedListener&&this.imageElement.removeEventListener("load",this.imageLoadedListener),
this.imageElement.src=void 0,this.imageElement.removeAttribute("src"),this.imageElement=void 0)}_destroyCaptureCanvas(){this.captureCanvas=this.captureCanvasContext=void 0}addVideoSource(a,b){try{a.srcObject=b}catch(c){a.src=URL.createObjectURL(b)}}cleanVideoSource(a){try{a.srcObject=null}catch(b){a.src=""}this.videoElement.removeAttribute("src")}}var Aa,q=Aa||(Aa={});q[q.AZTEC=0]="AZTEC";q[q.CODABAR=1]="CODABAR";q[q.CODE_39=2]="CODE_39";q[q.CODE_93=3]="CODE_93";q[q.CODE_128=4]="CODE_128";
q[q.DATA_MATRIX=5]="DATA_MATRIX";q[q.EAN_8=6]="EAN_8";q[q.EAN_13=7]="EAN_13";q[q.ITF=8]="ITF";q[q.MAXICODE=9]="MAXICODE";q[q.PDF_417=10]="PDF_417";q[q.QR_CODE=11]="QR_CODE";q[q.RSS_14=12]="RSS_14";q[q.RSS_EXPANDED=13]="RSS_EXPANDED";q[q.UPC_A=14]="UPC_A";q[q.UPC_E=15]="UPC_E";q[q.UPC_EAN_EXTENSION=16]="UPC_EAN_EXTENSION";var t=Aa,Ba,w=Ba||(Ba={});w[w.OTHER=0]="OTHER";w[w.PURE_BARCODE=1]="PURE_BARCODE";w[w.POSSIBLE_FORMATS=2]="POSSIBLE_FORMATS";w[w.TRY_HARDER=3]="TRY_HARDER";w[w.CHARACTER_SET=4]="CHARACTER_SET";
w[w.ALLOWED_LENGTHS=5]="ALLOWED_LENGTHS";w[w.ASSUME_CODE_39_CHECK_DIGIT=6]="ASSUME_CODE_39_CHECK_DIGIT";w[w.ASSUME_GS1=7]="ASSUME_GS1";w[w.RETURN_CODABAR_START_END=8]="RETURN_CODABAR_START_END";w[w.NEED_RESULT_POINT_CALLBACK=9]="NEED_RESULT_POINT_CALLBACK";w[w.ALLOWED_EAN_EXTENSIONS=10]="ALLOWED_EAN_EXTENSIONS";var x=Ba,Ca,y=Ca||(Ca={});y[y.OTHER=0]="OTHER";y[y.ORIENTATION=1]="ORIENTATION";y[y.BYTE_SEGMENTS=2]="BYTE_SEGMENTS";y[y.ERROR_CORRECTION_LEVEL=3]="ERROR_CORRECTION_LEVEL";
y[y.ISSUE_NUMBER=4]="ISSUE_NUMBER";y[y.SUGGESTED_PRICE=5]="SUGGESTED_PRICE";y[y.POSSIBLE_COUNTRY=6]="POSSIBLE_COUNTRY";y[y.UPC_EAN_EXTENSION=7]="UPC_EAN_EXTENSION";y[y.PDF417_EXTRA_METADATA=8]="PDF417_EXTRA_METADATA";y[y.STRUCTURED_APPEND_SEQUENCE=9]="STRUCTURED_APPEND_SEQUENCE";y[y.STRUCTURED_APPEND_PARITY=10]="STRUCTURED_APPEND_PARITY";var Da=Ca;
class Ea{MathUtils(){}static round(a){return a<=Number.MIN_SAFE_INTEGER?Number.MIN_SAFE_INTEGER:a>=Number.MAX_SAFE_INTEGER?Number.MAX_SAFE_INTEGER:a+(0>a?-.5:.5)|0}static distance(a,b,c,d){a-=c;b-=d;return Math.sqrt(a*a+b*b)}static sum(a){let b=0;for(let c=0,d=a.length;c!==d;c++)b+=a[c];return b}}class Ga{static floatToIntBits(a){return a}}
class z{constructor(a,b){this.x=a;this.y=b}getX(){return this.x}getY(){return this.y}equals(a){return a instanceof z?this.x===a.x&&this.y===a.y:!1}hashCode(){return 31*Ga.floatToIntBits(this.x)+Ga.floatToIntBits(this.y)}toString(){return"("+this.x+","+this.y+")"}static orderBestPatterns(a){var b=this.distance(a[0],a[1]),c=this.distance(a[1],a[2]),d=this.distance(a[0],a[2]);c>=b&&c>=d?(c=a[0],b=a[1],d=a[2]):d>=c&&d>=b?(c=a[1],b=a[0],d=a[2]):(c=a[2],b=a[0],d=a[1]);if(0>this.crossProductZ(b,c,d)){let a=
b;b=d;d=a}a[0]=b;a[1]=c;a[2]=d}static distance(a,b){return Ea.distance(a.x,a.y,b.x,b.y)}static crossProductZ(a,b,c){let d=b.x;b=b.y;return(c.x-d)*(a.y-b)-(c.y-b)*(a.x-d)}}
class C{decode(a,b){try{return this.doDecode(a,b)}catch(e){if(b&&!0===b.get(x.TRY_HARDER)&&a.isRotateSupported()){a=a.rotateCounterClockwise();b=this.doDecode(a,b);var c=b.getResultMetadata(),d=270;null!==c&&!0===c.get(Da.ORIENTATION)&&(d+=c.get(Da.ORIENTATION)%360);b.putMetadata(Da.ORIENTATION,d);c=b.getResultPoints();if(null!==c)for(a=a.getHeight(),d=0;d<c.length;d++)c[d]=new z(a-c[d].getY()-1,c[d].getX());return b}throw new m;}}reset(){}doDecode(a,b){let c=a.getWidth(),d=a.getHeight(),e=new na(c);
var f=b&&!0===b.get(x.TRY_HARDER);let g=Math.max(1,d>>(f?8:5));f=f?d:15;let h=Math.trunc(d/2);for(let r=0;r<f;r++){var l=Math.trunc((r+1)/2);l=h+g*(0===(r&1)?l:-l);if(0>l||l>=d)break;try{e=a.getBlackRow(l,e)}catch(u){continue}for(let a=0;2>a;a++){if(1===a&&(e.reverse(),b&&!0===b.get(x.NEED_RESULT_POINT_CALLBACK))){let a=new Map;b.forEach((b,c)=>a.set(c,b));a.delete(x.NEED_RESULT_POINT_CALLBACK);b=a}try{let d=this.decodeRow(l,e,b);if(1===a){d.putMetadata(Da.ORIENTATION,180);let a=d.getResultPoints();
null!==a&&(a[0]=new z(c-a[0].getX()-1,a[0].getY()),a[1]=new z(c-a[1].getX()-1,a[1].getY()))}return d}catch(v){}}}throw new m;}static recordPattern(a,b,c){let d=c.length;for(var e=0;e<d;e++)c[e]=0;e=a.getSize();if(b>=e)throw new m;let f=!a.get(b),g=0;for(;b<e;){if(a.get(b)!==f)c[g]++;else if(++g===d)break;else c[g]=1,f=!f;b++}if(g!==d&&(g!==d-1||b!==e))throw new m;}static recordPatternInReverse(a,b,c){let d=c.length,e=a.get(b);for(;0<b&&0<=d;)a.get(--b)!==e&&(d--,e=!e);if(0<=d)throw new m;C.recordPattern(a,
b+1,c)}static patternMatchVariance(a,b,c){let d=a.length,e=0;var f=0;for(var g=0;g<d;g++)e+=a[g],f+=b[g];if(e<f)return Number.POSITIVE_INFINITY;f=e/f;c*=f;g=0;for(let e=0;e<d;e++){var h=a[e];let d=b[e]*f;h=h>d?h-d:d-h;if(h>c)return Number.POSITIVE_INFINITY;g+=h}return g/e}}
class Ha{constructor(a,b,c,d,e,f){this.text=a;this.rawBytes=b;this.numBits=c;this.resultPoints=d;this.format=e;this.timestamp=f;this.text=a;this.rawBytes=b;this.numBits=void 0===c||null===c?null===b||void 0===b?0:8*b.length:c;this.resultPoints=d;this.format=e;this.resultMetadata=null;this.timestamp=void 0===f||null===f?ka.currentTimeMillis():f}getText(){return this.text}getRawBytes(){return this.rawBytes}getNumBits(){return this.numBits}getResultPoints(){return this.resultPoints}getBarcodeFormat(){return this.format}getResultMetadata(){return this.resultMetadata}putMetadata(a,
b){null===this.resultMetadata&&(this.resultMetadata=new Map);this.resultMetadata.set(a,b)}putAllMetadata(a){null!==a&&(this.resultMetadata=null===this.resultMetadata?a:new Map(a))}addResultPoints(a){let b=this.resultPoints;if(null===b)this.resultPoints=a;else if(null!==a&&0<a.length){let c=new z[b.length+a.length];ka.arraycopy(b,0,c,0,b.length);ka.arraycopy(a,0,c,b.length,a.length);this.resultPoints=c}}getTimestamp(){return this.timestamp}toString(){return this.text}}
class Ia extends C{constructor(a=!1,b=!1){super();this.usingCheckDigit=a;this.extendedMode=b;this.decodeRowResult="";this.counters=Array(9)}decodeRow(a,b){var c=this.counters;c.fill(0);this.decodeRowResult="";let d=Ia.findAsteriskPattern(b,c);var e=b.getNextSet(d[1]),f=b.getSize();let g;do{Ia.recordPattern(b,e,c);var h=Ia.toNarrowWidePattern(c);if(0>h)throw new m;g=Ia.patternToChar(h);this.decodeRowResult+=g;h=e;for(let a of c)e+=a;e=b.getNextSet(e)}while("*"!==g);this.decodeRowResult=this.decodeRowResult.substring(0,
this.decodeRowResult.length-1);b=0;for(let a of c)b+=a;if(e!==f&&2*(e-h-b)<b)throw new m;if(this.usingCheckDigit){c=this.decodeRowResult.length-1;e=0;for(f=0;f<c;f++)e+=Ia.ALPHABET_STRING.indexOf(this.decodeRowResult.charAt(f));if(this.decodeRowResult.charAt(c)!==Ia.ALPHABET_STRING.charAt(e%43))throw new ia;this.decodeRowResult=this.decodeRowResult.substring(0,c)}if(0===this.decodeRowResult.length)throw new m;c=this.extendedMode?Ia.decodeExtended(this.decodeRowResult):this.decodeRowResult;h+=b/2;
return new Ha(c,null,0,[new z((d[1]+d[0])/2,a),new z(h,a)],t.CODE_39,(new Date).getTime())}static findAsteriskPattern(a,b){let c=a.getSize();var d=a.getNextSet(0);let e=0,f=d,g=!1,h=b.length;for(;d<c;d++)if(a.get(d)!==g)b[e]++;else{if(e===h-1){if(this.toNarrowWidePattern(b)===Ia.ASTERISK_ENCODING&&a.isRange(Math.max(0,f-Math.floor((d-f)/2)),f,!1))return[f,d];f+=b[0]+b[1];b.copyWithin(0,2,2+e-1);b[e-1]=0;b[e]=0;e--}else e++;b[e]=1;g=!g}throw new m;}static toNarrowWidePattern(a){let b=a.length,c=0;
do{var d=2147483647;for(var e of a)e<d&&e>c&&(d=e);c=d;let g=d=0,h=0;for(var f=0;f<b;f++){let e=a[f];e>c&&(h|=1<<b-1-f,d++,g+=e)}if(3===d){for(e=0;e<b&&0<d;e++)if(f=a[e],f>c&&(d--,2*f>=g))return-1;return h}}while(3<d);return-1}static patternToChar(a){for(let b=0;b<Ia.CHARACTER_ENCODINGS.length;b++)if(Ia.CHARACTER_ENCODINGS[b]===a)return Ia.ALPHABET_STRING.charAt(b);if(a===Ia.ASTERISK_ENCODING)return"*";throw new m;}static decodeExtended(a){let b=a.length,c="";for(let d=0;d<b;d++){let b=a.charAt(d);
if("+"===b||"$"===b||"%"===b||"/"===b){let e=a.charAt(d+1),g="\x00";switch(b){case "+":if("A"<=e&&"Z">=e)g=String.fromCharCode(e.charCodeAt(0)+32);else throw new p;break;case "$":if("A"<=e&&"Z">=e)g=String.fromCharCode(e.charCodeAt(0)-64);else throw new p;break;case "%":if("A"<=e&&"E">=e)g=String.fromCharCode(e.charCodeAt(0)-38);else if("F"<=e&&"J">=e)g=String.fromCharCode(e.charCodeAt(0)-11);else if("K"<=e&&"O">=e)g=String.fromCharCode(e.charCodeAt(0)+16);else if("P"<=e&&"T">=e)g=String.fromCharCode(e.charCodeAt(0)+
43);else if("U"===e)g="\x00";else if("V"===e)g="@";else if("W"===e)g="`";else if("X"===e||"Y"===e||"Z"===e)g="\u007f";else throw new p;break;case "/":if("A"<=e&&"O">=e)g=String.fromCharCode(e.charCodeAt(0)-32);else if("Z"===e)g=":";else throw new p;}c+=g;d++}else c+=b}return c}}Ia.ALPHABET_STRING="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ-. $/+%";
Ia.CHARACTER_ENCODINGS=[52,289,97,352,49,304,112,37,292,100,265,73,328,25,280,88,13,268,76,28,259,67,322,19,274,82,7,262,70,22,385,193,448,145,400,208,133,388,196,168,162,138,42];Ia.ASTERISK_ENCODING=148;
class D extends C{static findStartPattern(a){let b=a.getSize();var c=a.getNextSet(0);let d=0,e=[0,0,0,0,0,0],f=c,g=!1;for(;c<b;c++)if(a.get(c)!==g)e[d]++;else{if(5===d){let b=D.MAX_AVG_VARIANCE,g=-1;for(let a=D.CODE_START_A;a<=D.CODE_START_C;a++){let c=C.patternMatchVariance(e,D.CODE_PATTERNS[a],D.MAX_INDIVIDUAL_VARIANCE);c<b&&(b=c,g=a)}if(0<=g&&a.isRange(Math.max(0,f-(c-f)/2),f,!1))return[f,c,g];f+=e[0]+e[1];e.splice(0,2);e[d-1]=0;e[d]=0;d--}else d++;e[d]=1;g=!g}throw new m;}static decodeCode(a,
b,c){C.recordPattern(a,c,b);a=D.MAX_AVG_VARIANCE;c=-1;for(let d=0;d<D.CODE_PATTERNS.length;d++){let e=this.patternMatchVariance(b,D.CODE_PATTERNS[d],D.MAX_INDIVIDUAL_VARIANCE);e<a&&(a=e,c=d)}if(0<=c)return c;throw new m;}decodeRow(a,b,c){var d=c&&!0===c.get(x.ASSUME_GS1),e=D.findStartPattern(b),f=e[2];let g=0,h=new Uint8Array(20);h[g++]=f;switch(f){case D.CODE_START_A:var l=D.CODE_CODE_A;break;case D.CODE_START_B:l=D.CODE_CODE_B;break;case D.CODE_START_C:l=D.CODE_CODE_C;break;default:throw new p;
}let r=!1,u=!1;c="";var v=e[0],A=e[1];let E=[0,0,0,0,0,0],T=0,B=0,Fa=f,ya=0;f=!0;let qa=!1,fa=!1;for(;!r;){let a=u;u=!1;T=B;B=D.decodeCode(b,E,A);h[g++]=B;B!==D.CODE_STOP&&(f=!0);B!==D.CODE_STOP&&(ya++,Fa+=ya*B);v=A;A+=E.reduce((a,b)=>a+b,0);switch(B){case D.CODE_START_A:case D.CODE_START_B:case D.CODE_START_C:throw new p;}switch(l){case D.CODE_CODE_A:if(64>B)c=fa===qa?c+String.fromCharCode(32+B):c+String.fromCharCode(32+B+128),fa=!1;else if(96>B)c=fa===qa?c+String.fromCharCode(B-64):c+String.fromCharCode(B+
64),fa=!1;else switch(B!==D.CODE_STOP&&(f=!1),B){case D.CODE_FNC_1:d&&(c=0===c.length?c+"]C1":c+String.fromCharCode(29));break;case D.CODE_FNC_4_A:!qa&&fa?(qa=!0,fa=!1):fa=qa&&fa?qa=!1:!0;break;case D.CODE_SHIFT:u=!0;l=D.CODE_CODE_B;break;case D.CODE_CODE_B:l=D.CODE_CODE_B;break;case D.CODE_CODE_C:l=D.CODE_CODE_C;break;case D.CODE_STOP:r=!0}break;case D.CODE_CODE_B:if(96>B)c=fa===qa?c+String.fromCharCode(32+B):c+String.fromCharCode(32+B+128),fa=!1;else switch(B!==D.CODE_STOP&&(f=!1),B){case D.CODE_FNC_1:d&&
(c=0===c.length?c+"]C1":c+String.fromCharCode(29));break;case D.CODE_FNC_4_B:!qa&&fa?(qa=!0,fa=!1):fa=qa&&fa?qa=!1:!0;break;case D.CODE_SHIFT:u=!0;l=D.CODE_CODE_A;break;case D.CODE_CODE_A:l=D.CODE_CODE_A;break;case D.CODE_CODE_C:l=D.CODE_CODE_C;break;case D.CODE_STOP:r=!0}break;case D.CODE_CODE_C:if(100>B)10>B&&(c+="0"),c+=B;else switch(B!==D.CODE_STOP&&(f=!1),B){case D.CODE_FNC_1:d&&(c=0===c.length?c+"]C1":c+String.fromCharCode(29));break;case D.CODE_CODE_A:l=D.CODE_CODE_A;break;case D.CODE_CODE_B:l=
D.CODE_CODE_B;break;case D.CODE_STOP:r=!0}}a&&(l=l===D.CODE_CODE_A?D.CODE_CODE_B:D.CODE_CODE_A)}d=A-v;A=b.getNextUnset(A);if(!b.isRange(A,Math.min(b.getSize(),A+(A-v)/2),!1))throw new m;if((Fa-ya*T)%103!==T)throw new ia;b=c.length;if(0===b)throw new m;0<b&&f&&(c=l===D.CODE_CODE_C?c.substring(0,b-2):c.substring(0,b-1));b=(e[1]+e[0])/2;e=v+d/2;l=h.length;v=new Uint8Array(l);for(A=0;A<l;A++)v[A]=h[A];a=[new z(b,a),new z(e,a)];return new Ha(c,v,0,a,t.CODE_128,(new Date).getTime())}}
D.CODE_PATTERNS=[[2,1,2,2,2,2],[2,2,2,1,2,2],[2,2,2,2,2,1],[1,2,1,2,2,3],[1,2,1,3,2,2],[1,3,1,2,2,2],[1,2,2,2,1,3],[1,2,2,3,1,2],[1,3,2,2,1,2],[2,2,1,2,1,3],[2,2,1,3,1,2],[2,3,1,2,1,2],[1,1,2,2,3,2],[1,2,2,1,3,2],[1,2,2,2,3,1],[1,1,3,2,2,2],[1,2,3,1,2,2],[1,2,3,2,2,1],[2,2,3,2,1,1],[2,2,1,1,3,2],[2,2,1,2,3,1],[2,1,3,2,1,2],[2,2,3,1,1,2],[3,1,2,1,3,1],[3,1,1,2,2,2],[3,2,1,1,2,2],[3,2,1,2,2,1],[3,1,2,2,1,2],[3,2,2,1,1,2],[3,2,2,2,1,1],[2,1,2,1,2,3],[2,1,2,3,2,1],[2,3,2,1,2,1],[1,1,1,3,2,3],[1,3,1,1,
2,3],[1,3,1,3,2,1],[1,1,2,3,1,3],[1,3,2,1,1,3],[1,3,2,3,1,1],[2,1,1,3,1,3],[2,3,1,1,1,3],[2,3,1,3,1,1],[1,1,2,1,3,3],[1,1,2,3,3,1],[1,3,2,1,3,1],[1,1,3,1,2,3],[1,1,3,3,2,1],[1,3,3,1,2,1],[3,1,3,1,2,1],[2,1,1,3,3,1],[2,3,1,1,3,1],[2,1,3,1,1,3],[2,1,3,3,1,1],[2,1,3,1,3,1],[3,1,1,1,2,3],[3,1,1,3,2,1],[3,3,1,1,2,1],[3,1,2,1,1,3],[3,1,2,3,1,1],[3,3,2,1,1,1],[3,1,4,1,1,1],[2,2,1,4,1,1],[4,3,1,1,1,1],[1,1,1,2,2,4],[1,1,1,4,2,2],[1,2,1,1,2,4],[1,2,1,4,2,1],[1,4,1,1,2,2],[1,4,1,2,2,1],[1,1,2,2,1,4],[1,1,2,
4,1,2],[1,2,2,1,1,4],[1,2,2,4,1,1],[1,4,2,1,1,2],[1,4,2,2,1,1],[2,4,1,2,1,1],[2,2,1,1,1,4],[4,1,3,1,1,1],[2,4,1,1,1,2],[1,3,4,1,1,1],[1,1,1,2,4,2],[1,2,1,1,4,2],[1,2,1,2,4,1],[1,1,4,2,1,2],[1,2,4,1,1,2],[1,2,4,2,1,1],[4,1,1,2,1,2],[4,2,1,1,1,2],[4,2,1,2,1,1],[2,1,2,1,4,1],[2,1,4,1,2,1],[4,1,2,1,2,1],[1,1,1,1,4,3],[1,1,1,3,4,1],[1,3,1,1,4,1],[1,1,4,1,1,3],[1,1,4,3,1,1],[4,1,1,1,1,3],[4,1,1,3,1,1],[1,1,3,1,4,1],[1,1,4,1,3,1],[3,1,1,1,4,1],[4,1,1,1,3,1],[2,1,1,4,1,2],[2,1,1,2,1,4],[2,1,1,2,3,2],[2,3,
3,1,1,1,2]];D.MAX_AVG_VARIANCE=.25;D.MAX_INDIVIDUAL_VARIANCE=.7;D.CODE_SHIFT=98;D.CODE_CODE_C=99;D.CODE_CODE_B=100;D.CODE_CODE_A=101;D.CODE_FNC_1=102;D.CODE_FNC_2=97;D.CODE_FNC_3=96;D.CODE_FNC_4_A=101;D.CODE_FNC_4_B=100;D.CODE_START_A=103;D.CODE_START_B=104;D.CODE_START_C=105;D.CODE_STOP=106;
class Ja extends C{constructor(){super();this.decodeFinderCounters=Array(4);this.dataCharacterCounters=Array(8);this.oddRoundingErrors=Array(4);this.evenRoundingErrors=Array(4);this.oddCounts=Array(this.dataCharacterCounters.length/2);this.evenCounts=Array(this.dataCharacterCounters.length/2)}getDecodeFinderCounters(){return this.decodeFinderCounters}getDataCharacterCounters(){return this.dataCharacterCounters}getOddRoundingErrors(){return this.oddRoundingErrors}getEvenRoundingErrors(){return this.evenRoundingErrors}getOddCounts(){return this.oddCounts}getEvenCounts(){return this.evenCounts}parseFinderValue(a,
b){for(let c=0;c<b.length;c++)if(C.patternMatchVariance(a,b[c],Ja.MAX_INDIVIDUAL_VARIANCE)<Ja.MAX_AVG_VARIANCE)return c;throw new m;}static count(a){return Ea.sum(new Int32Array(a))}static increment(a,b){let c=0,d=b[0];for(let e=1;e<a.length;e++)b[e]>d&&(d=b[e],c=e);a[c]++}static decrement(a,b){let c=0,d=b[0];for(let e=1;e<a.length;e++)b[e]<d&&(d=b[e],c=e);a[c]--}static isFinderPattern(a){var b=a[0]+a[1];b/=b+a[2]+a[3];if(b>=Ja.MIN_FINDER_PATTERN_RATIO&&b<=Ja.MAX_FINDER_PATTERN_RATIO){b=Number.MAX_SAFE_INTEGER;
let c=Number.MIN_SAFE_INTEGER;for(let d of a)d>c&&(c=d),d<b&&(b=d);return c<10*b}return!1}}Ja.MAX_AVG_VARIANCE=.2;Ja.MAX_INDIVIDUAL_VARIANCE=.45;Ja.MIN_FINDER_PATTERN_RATIO=9.5/12;Ja.MAX_FINDER_PATTERN_RATIO=12.5/14;
class Ka{constructor(a,b){this.value=a;this.checksumPortion=b}getValue(){return this.value}getChecksumPortion(){return this.checksumPortion}toString(){return this.value+"("+this.checksumPortion+")"}equals(a){return a instanceof Ka?this.value===a.value&&this.checksumPortion===a.checksumPortion:!1}hashCode(){return this.value^this.checksumPortion}}
class La extends Ka{constructor(a,b,c){super(a,b);this.count=0;this.finderPattern=c}getFinderPattern(){return this.finderPattern}getCount(){return this.count}incrementCount(){this.count++}}
class Ma{constructor(a,b,c,d,e){this.value=a;this.startEnd=b;this.value=a;this.startEnd=b;this.resultPoints=[];this.resultPoints.push(new z(c,e));this.resultPoints.push(new z(d,e))}getValue(){return this.value}getStartEnd(){return this.startEnd}getResultPoints(){return this.resultPoints}equals(a){return a instanceof Ma?this.value===a.value:!1}hashCode(){return this.value}}
class Na{RSSUtils(){}static getRSSvalue(a,b,c){let d=0;for(var e of a)d+=e;let f=e=0,g=a.length;for(let h=0;h<g-1;h++){let l;l=1;for(f|=1<<h;l<a[h];l++,f&=~(1<<h)){let a=Na.combins(d-l-1,g-h-2);c&&0===f&&d-l-(g-h-1)>=g-h-1&&(a-=Na.combins(d-l-(g-h),g-h-2));if(1<g-h-1){let c=0;for(let a=d-l-(g-h-2);a>b;a--)c+=Na.combins(d-l-a-1,g-h-3);a-=c*(g-1-h)}else d-l>b&&a--;e+=a}d-=l}return e}static combins(a,b){let c;a-b>b?(c=b,b=a-b):c=a-b;let d=1,e=1;for(;a>b;a--)d*=a,e<=c&&(d/=e,e++);for(;e<=c;)d/=e,e++;
return d}}
class F extends Ja{constructor(){super(...arguments);this.possibleLeftPairs=[];this.possibleRightPairs=[]}decodeRow(a,b,c){let d=this.decodePair(b,!1,a,c);F.addOrTally(this.possibleLeftPairs,d);b.reverse();a=this.decodePair(b,!0,a,c);F.addOrTally(this.possibleRightPairs,a);b.reverse();for(let a of this.possibleLeftPairs)if(1<a.getCount())for(let b of this.possibleRightPairs)if(1<b.getCount()&&F.checkChecksum(a,b))return F.constructResult(a,b);throw new m;}static addOrTally(a,b){if(null!=b){var c=
!1;for(let d of a)if(d.getValue()===b.getValue()){d.incrementCount();c=!0;break}c||a.push(b)}}reset(){this.possibleLeftPairs.length=0;this.possibleRightPairs.length=0}static constructResult(a,b){var c=4537077*a.getValue()+b.getValue(),d=(new String(c)).toString();c=new oa;for(var e=13-d.length;0<e;e--)c.append("0");c.append(d);d=0;for(e=0;13>e;e++){let a=c.charAt(e).charCodeAt(0)-48;d+=0===(e&1)?3*a:a}d=10-d%10;10===d&&(d=0);c.append(d.toString());a=a.getFinderPattern().getResultPoints();b=b.getFinderPattern().getResultPoints();
return new Ha(c.toString(),null,0,[a[0],a[1],b[0],b[1]],t.RSS_14,(new Date).getTime())}static checkChecksum(a,b){let c=(a.getChecksumPortion()+16*b.getChecksumPortion())%79;a=9*a.getFinderPattern().getValue()+b.getFinderPattern().getValue();72<a&&a--;8<a&&a--;return c===a}decodePair(a,b,c,d){try{let e=this.findFinderPattern(a,b),f=this.parseFoundFinderPattern(a,c,b,e),g=null==d?null:d.get(x.NEED_RESULT_POINT_CALLBACK);if(null!=g){let d=(e[0]+e[1])/2;b&&(d=a.getSize()-1-d);g.foundPossibleResultPoint(new z(d,
c))}let h=this.decodeDataCharacter(a,f,!0),l=this.decodeDataCharacter(a,f,!1);return new La(1597*h.getValue()+l.getValue(),h.getChecksumPortion()+4*l.getChecksumPortion(),f)}catch(e){return null}}decodeDataCharacter(a,b,c){var d=this.getDataCharacterCounters();for(var e=0;e<d.length;e++)d[e]=0;if(c)C.recordPatternInReverse(a,b.getStartEnd()[0],d);else{C.recordPattern(a,b.getStartEnd()[1]+1,d);for(let b=0,c=d.length-1;b<c;b++,c--)a=d[b],d[b]=d[c],d[c]=a}e=c?16:15;var f=Ea.sum(new Int32Array(d))/e;
b=this.getOddCounts();a=this.getEvenCounts();var g=this.getOddRoundingErrors(),h=this.getEvenRoundingErrors();for(let c=0;c<d.length;c++){let e=d[c]/f,l=Math.floor(e+.5);1>l?l=1:8<l&&(l=8);let v=Math.floor(c/2);0===(c&1)?(b[v]=l,g[v]=e-l):(a[v]=l,h[v]=e-l)}this.adjustOddEvenCounts(c,e);d=e=0;for(f=b.length-1;0<=f;f--)d*=9,d+=b[f],e+=b[f];f=g=0;for(h=a.length-1;0<=h;h--)g*=9,g+=a[h],f+=a[h];d+=3*g;if(c){if(0!==(e&1)||12<e||4>e)throw new m;c=(12-e)/2;f=F.OUTSIDE_ODD_WIDEST[c];e=9-f;b=Na.getRSSvalue(b,
f,!1);a=Na.getRSSvalue(a,e,!0);return new Ka(b*F.OUTSIDE_EVEN_TOTAL_SUBSET[c]+a+F.OUTSIDE_GSUM[c],d)}if(0!==(f&1)||10<f||4>f)throw new m;c=(10-f)/2;f=F.INSIDE_ODD_WIDEST[c];e=9-f;b=Na.getRSSvalue(b,f,!0);a=Na.getRSSvalue(a,e,!1);return new Ka(a*F.INSIDE_ODD_TOTAL_SUBSET[c]+b+F.INSIDE_GSUM[c],d)}findFinderPattern(a,b){let c=this.getDecodeFinderCounters();c[0]=0;c[1]=0;c[2]=0;c[3]=0;let d=a.getSize(),e=!1;for(var f=0;f<d;){e=!a.get(f);if(b===e)break;f++}b=0;let g=f;for(;f<d;f++)if(a.get(f)!==e)c[b]++;
else{if(3===b){if(Ja.isFinderPattern(c))return[g,f];g+=c[0]+c[1];c[0]=c[2];c[1]=c[3];c[2]=0;c[3]=0;b--}else b++;c[b]=1;e=!e}throw new m;}parseFoundFinderPattern(a,b,c,d){var e=a.get(d[0]);let f=d[0]-1;for(;0<=f&&e!==a.get(f);)f--;f++;e=d[0]-f;var g=this.getDecodeFinderCounters(),h=Array(g.length);ka.arraycopy(g,0,h,1,g.length-1);h[0]=e;e=this.parseFinderValue(h,F.FINDER_PATTERNS);g=f;h=d[1];c&&(g=a.getSize()-1-g,h=a.getSize()-1-h);return new Ma(e,[f,d[1]],g,h,b)}adjustOddEvenCounts(a,b){let c=Ea.sum(new Int32Array(this.getOddCounts())),
d=Ea.sum(new Int32Array(this.getEvenCounts())),e=!1,f=!1,g=!1,h=!1;a?(12<c?f=!0:4>c&&(e=!0),12<d?h=!0:4>d&&(g=!0)):(11<c?f=!0:5>c&&(e=!0),10<d?h=!0:4>d&&(g=!0));b=c+d-b;a=(c&1)===(a?1:0);let l=1===(d&1);if(1===b)if(a){if(l)throw new m;f=!0}else{if(!l)throw new m;h=!0}else if(-1===b)if(a){if(l)throw new m;e=!0}else{if(!l)throw new m;g=!0}else if(0===b)if(a){if(!l)throw new m;c<d?h=e=!0:g=f=!0}else{if(l)throw new m;}else throw new m;if(e){if(f)throw new m;Ja.increment(this.getOddCounts(),this.getOddRoundingErrors())}f&&
Ja.decrement(this.getOddCounts(),this.getOddRoundingErrors());if(g){if(h)throw new m;Ja.increment(this.getEvenCounts(),this.getOddRoundingErrors())}h&&Ja.decrement(this.getEvenCounts(),this.getEvenRoundingErrors())}}F.OUTSIDE_EVEN_TOTAL_SUBSET=[1,10,34,70,126];F.INSIDE_ODD_TOTAL_SUBSET=[4,20,48,81];F.OUTSIDE_GSUM=[0,161,961,2015,2715];F.INSIDE_GSUM=[0,336,1036,1516];F.OUTSIDE_ODD_WIDEST=[8,6,4,3,1];F.INSIDE_ODD_WIDEST=[2,4,6,8];
F.FINDER_PATTERNS=[[3,8,2,1],[3,5,5,1],[3,3,7,1],[3,1,9,1],[2,7,4,1],[2,5,6,1],[2,3,8,1],[1,5,7,1],[1,3,9,1]];
class G extends C{constructor(){super(...arguments);this.narrowLineWidth=-1}decodeRow(a,b,c){let d=this.decodeStart(b),e=this.decodeEnd(b);var f=new oa;G.decodeMiddle(b,d[1],e[0],f);b=f.toString();f=null;null!=c&&(f=c.get(x.ALLOWED_LENGTHS));null==f&&(f=G.DEFAULT_ALLOWED_LENGTHS);c=b.length;let g=!1,h=0;for(let a of f){if(c===a){g=!0;break}a>h&&(h=a)}!g&&c>h&&(g=!0);if(!g)throw new p;a=[new z(d[1],a),new z(e[0],a)];return new Ha(b,null,0,a,t.ITF,(new Date).getTime())}static decodeMiddle(a,b,c,d){let e=
Array(10),f=Array(5),g=Array(5);e.fill(0);f.fill(0);for(g.fill(0);b<c;){C.recordPattern(a,b,e);for(var h=0;5>h;h++){let a=2*h;f[h]=e[a];g[h]=e[a+1]}h=G.decodeDigit(f);d.append(h.toString());h=this.decodeDigit(g);d.append(h.toString());e.forEach(function(a){b+=a})}}decodeStart(a){var b=G.skipWhiteSpace(a);b=G.findGuardPattern(a,b,G.START_PATTERN);this.narrowLineWidth=(b[1]-b[0])/4;this.validateQuietZone(a,b[0]);return b}validateQuietZone(a,b){let c=10*this.narrowLineWidth;c=c<b?c:b;for(--b;0<c&&0<=
b&&!a.get(b);b--)c--;if(0!==c)throw new m;}static skipWhiteSpace(a){let b=a.getSize();a=a.getNextSet(0);if(a===b)throw new m;return a}decodeEnd(a){a.reverse();try{let b=G.skipWhiteSpace(a),c;try{c=G.findGuardPattern(a,b,G.END_PATTERN_REVERSED[0])}catch(e){c=G.findGuardPattern(a,b,G.END_PATTERN_REVERSED[1])}this.validateQuietZone(a,c[0]);let d=c[0];c[0]=a.getSize()-c[1];c[1]=a.getSize()-d;return c}finally{a.reverse()}}static findGuardPattern(a,b,c){let d=c.length,e=Array(d),f=a.getSize(),g=!1,h=0,
l=b;for(e.fill(0);b<f;b++)if(a.get(b)!==g)e[h]++;else{if(h===d-1){if(C.patternMatchVariance(e,c,G.MAX_INDIVIDUAL_VARIANCE)<G.MAX_AVG_VARIANCE)return[l,b];l+=e[0]+e[1];ka.arraycopy(e,2,e,0,h-1);e[h-1]=0;e[h]=0;h--}else h++;e[h]=1;g=!g}throw new m;}static decodeDigit(a){let b=G.MAX_AVG_VARIANCE,c=-1,d=G.PATTERNS.length;for(let e=0;e<d;e++){let d=C.patternMatchVariance(a,G.PATTERNS[e],G.MAX_INDIVIDUAL_VARIANCE);d<b?(b=d,c=e):d===b&&(c=-1)}if(0<=c)return c%10;throw new m;}}G.W=3;G.w=2;G.N=1;
G.PATTERNS=[[1,1,2,2,1],[2,1,1,1,2],[1,2,1,1,2],[2,2,1,1,1],[1,1,2,1,2],[2,1,2,1,1],[1,2,2,1,1],[1,1,1,2,2],[2,1,1,2,1],[1,2,1,2,1],[1,1,3,3,1],[3,1,1,1,3],[1,3,1,1,3],[3,3,1,1,1],[1,1,3,1,3],[3,1,3,1,1],[1,3,3,1,1],[1,1,1,3,3],[3,1,1,3,1],[1,3,1,3,1]];G.MAX_AVG_VARIANCE=.38;G.MAX_INDIVIDUAL_VARIANCE=.5;G.DEFAULT_ALLOWED_LENGTHS=[6,8,10,12,14];G.START_PATTERN=[1,1,1,1];G.END_PATTERN_REVERSED=[[1,1,2],[1,1,3]];
class Oa{constructor(){this.CHECK_DIGIT_ENCODINGS=[24,20,18,17,12,6,3,10,9,5];this.decodeMiddleCounters=[0,0,0,0];this.decodeRowStringBuffer=""}decodeRow(a,b,c){var d=this.decodeRowStringBuffer;b=this.decodeMiddle(b,c,d);let e=d.toString();d=Oa.parseExtensionString(e);a=[new z((c[0]+c[1])/2,a),new z(b,a)];a=new Ha(e,null,0,a,t.UPC_EAN_EXTENSION,(new Date).getTime());null!=d&&a.putAllMetadata(d);return a}decodeMiddle(a,b,c){let d=this.decodeMiddleCounters;d[0]=0;d[1]=0;d[2]=0;d[3]=0;let e=a.getSize();
b=b[1];let f=0;for(let g=0;5>g&&b<e;g++){let e=H.decodeDigit(a,d,b,H.L_AND_G_PATTERNS);c+=String.fromCharCode(48+e%10);for(let a of d)b+=a;10<=e&&(f|=1<<4-g);4!==g&&(b=a.getNextSet(b),b=a.getNextUnset(b))}if(5!==c.length)throw new m;a=this.determineCheckDigit(f);if(Oa.extensionChecksum(c.toString())!==a)throw new m;return b}static extensionChecksum(a){var b=a.length;let c=0;for(let d=b-2;0<=d;d-=2)c+=a.charAt(d).charCodeAt(0)-48;c*=3;for(--b;0<=b;b-=2)c+=a.charAt(b).charCodeAt(0)-48;return 3*c%10}determineCheckDigit(a){for(let b=
0;10>b;b++)if(a===this.CHECK_DIGIT_ENCODINGS[b])return b;throw new m;}static parseExtensionString(a){if(5!==a.length)return null;a=Oa.parseExtension5String(a);return null==a?null:new Map([[Da.SUGGESTED_PRICE,a]])}static parseExtension5String(a){let b;switch(a.charAt(0)){case "0":b="\u00a3";break;case "5":b="$";break;case "9":switch(a){case "90000":return null;case "99991":return"0.00";case "99990":return"Used"}b="";break;default:b=""}a=parseInt(a.substring(1));let c=a%100;return b+(a/100).toString()+
"."+(10>c?"0"+c:c.toString())}}
class Pa{constructor(){this.decodeMiddleCounters=[0,0,0,0];this.decodeRowStringBuffer=""}decodeRow(a,b,c){var d=this.decodeRowStringBuffer;b=this.decodeMiddle(b,c,d);let e=d.toString();d=Pa.parseExtensionString(e);a=[new z((c[0]+c[1])/2,a),new z(b,a)];a=new Ha(e,null,0,a,t.UPC_EAN_EXTENSION,(new Date).getTime());null!=d&&a.putAllMetadata(d);return a}decodeMiddle(a,b,c){let d=this.decodeMiddleCounters;d[0]=0;d[1]=0;d[2]=0;d[3]=0;let e=a.getSize();b=b[1];let f=0;for(let g=0;2>g&&b<e;g++){let e=H.decodeDigit(a,
d,b,H.L_AND_G_PATTERNS);c+=String.fromCharCode(48+e%10);for(let a of d)b+=a;10<=e&&(f|=1<<1-g);1!==g&&(b=a.getNextSet(b),b=a.getNextUnset(b))}if(2!==c.length)throw new m;if(parseInt(c.toString())%4!==f)throw new m;return b}static parseExtensionString(a){return 2!==a.length?null:new Map([[Da.ISSUE_NUMBER,parseInt(a)]])}}
class Qa{static decodeRow(a,b,c){c=H.findGuardPattern(b,c,!1,this.EXTENSION_START_PATTERN,Array(this.EXTENSION_START_PATTERN.length).fill(0));try{return(new Oa).decodeRow(a,b,c)}catch(d){return(new Pa).decodeRow(a,b,c)}}}Qa.EXTENSION_START_PATTERN=[1,1,2];
class H extends C{constructor(){super();this.decodeRowStringBuffer=this.decodeRowStringBuffer="";H.L_AND_G_PATTERNS=H.L_PATTERNS.map(function(a){return a.slice()});for(let a=10;20>a;a++){let b=H.L_PATTERNS[a-10],c=Array(b.length);for(let a=0;a<b.length;a++)c[a]=b[b.length-a-1];H.L_AND_G_PATTERNS[a]=c}}static findStartGuardPattern(a){let b=!1;var c=null;let d=0;for(;!b;){c=[0,0,0];c=H.findGuardPattern(a,d,!1,this.START_END_PATTERN,c);let e=c[0];d=c[1];let f=e-(d-e);0<=f&&(b=a.isRange(f,e,!1))}return c}decodeRow(a,
b,c){var d=H.findStartGuardPattern(b),e=null==c?null:c.get(x.NEED_RESULT_POINT_CALLBACK);if(null!=e){var f=new z((d[0]+d[1])/2,a);e.foundPossibleResultPoint(f)}var g=this.decodeMiddle(b,d,this.decodeRowStringBuffer);f=g.rowOffset;g=g.resultString;if(null!=e){var h=new z(f,a);e.foundPossibleResultPoint(h)}f=H.decodeEnd(b,f);null!=e&&(h=new z((f[0]+f[1])/2,a),e.foundPossibleResultPoint(h));e=f[1];h=e+(e-f[0]);if(h>=b.getSize()||!b.isRange(e,h,!1))throw new m;e=g.toString();if(8>e.length)throw new p;
if(!H.checkChecksum(e))throw new ia;g=(d[1]+d[0])/2;h=(f[1]+f[0])/2;d=this.getBarcodeFormat();g=[new z(g,a),new z(h,a)];d=new Ha(e,null,0,g,d,(new Date).getTime());e=0;try{let c=Qa.decodeRow(a,b,f[1]);d.putMetadata(Da.UPC_EAN_EXTENSION,c.getText());d.putAllMetadata(c.getResultMetadata());d.addResultPoints(c.getResultPoints());e=c.getText().length}catch(l){}a=null==c?null:c.get(x.ALLOWED_EAN_EXTENSIONS);if(null!=a){b=!1;for(let c in a)if(e.toString()===c){b=!0;break}if(!b)throw new m;}return d}static checkChecksum(a){return H.checkStandardUPCEANChecksum(a)}static checkStandardUPCEANChecksum(a){let b=
a.length;if(0===b)return!1;let c=parseInt(a.charAt(b-1),10);return H.getStandardUPCEANChecksum(a.substring(0,b-1))===c}static getStandardUPCEANChecksum(a){var b=a.length;let c=0;for(var d=b-1;0<=d;d-=2){let b=a.charAt(d).charCodeAt(0)-48;if(0>b||9<b)throw new p;c+=b}c*=3;for(b-=2;0<=b;b-=2){d=a.charAt(b).charCodeAt(0)-48;if(0>d||9<d)throw new p;c+=d}return(1E3-c)%10}static decodeEnd(a,b){return H.findGuardPattern(a,b,!1,H.START_END_PATTERN,Array(H.START_END_PATTERN.length).fill(0))}static findGuardPattern(a,
b,c,d,e){let f=a.getSize();b=c?a.getNextUnset(b):a.getNextSet(b);let g=0,h=b,l=d.length;for(;b<f;b++)if(a.get(b)!==c)e[g]++;else{if(g===l-1){if(C.patternMatchVariance(e,d,H.MAX_INDIVIDUAL_VARIANCE)<H.MAX_AVG_VARIANCE)return[h,b];h+=e[0]+e[1];let a=e.slice(2,e.length);for(let b=0;b<g-1;b++)e[b]=a[b];e[g-1]=0;e[g]=0;g--}else g++;e[g]=1;c=!c}throw new m;}static decodeDigit(a,b,c,d){this.recordPattern(a,c,b);a=this.MAX_AVG_VARIANCE;c=-1;let e=d.length;for(let f=0;f<e;f++){let e=C.patternMatchVariance(b,
d[f],H.MAX_INDIVIDUAL_VARIANCE);e<a&&(a=e,c=f)}if(0<=c)return c;throw new m;}}H.MAX_AVG_VARIANCE=.48;H.MAX_INDIVIDUAL_VARIANCE=.7;H.START_END_PATTERN=[1,1,1];H.MIDDLE_PATTERN=[1,1,1,1,1];H.END_PATTERN=[1,1,1,1,1,1];H.L_PATTERNS=[[3,2,1,1],[2,2,2,1],[2,1,2,2],[1,4,1,1],[1,1,3,2],[1,2,3,1],[1,1,1,4],[1,3,1,2],[1,2,1,3],[3,1,1,2]];
class Ra extends H{constructor(){super();this.decodeMiddleCounters=[0,0,0,0]}decodeMiddle(a,b,c){let d=this.decodeMiddleCounters;d[0]=0;d[1]=0;d[2]=0;d[3]=0;let e=a.getSize();b=b[1];var f=0;for(let h=0;6>h&&b<e;h++){let e=H.decodeDigit(a,d,b,H.L_AND_G_PATTERNS);c+=String.fromCharCode(48+e%10);for(var g of d)b+=g;10<=e&&(f|=1<<5-h)}c=Ra.determineFirstDigit(c,f);b=H.findGuardPattern(a,b,!0,H.MIDDLE_PATTERN,Array(H.MIDDLE_PATTERN.length).fill(0))[1];for(g=0;6>g&&b<e;g++){f=H.decodeDigit(a,d,b,H.L_PATTERNS);
c+=String.fromCharCode(48+f);for(let a of d)b+=a}return{rowOffset:b,resultString:c}}getBarcodeFormat(){return t.EAN_13}static determineFirstDigit(a,b){for(let c=0;10>c;c++)if(b===this.FIRST_DIGIT_ENCODINGS[c])return a=String.fromCharCode(48+c)+a;throw new m;}}Ra.FIRST_DIGIT_ENCODINGS=[0,11,13,14,19,25,28,21,22,26];
class Sa extends H{constructor(){super();this.decodeMiddleCounters=[0,0,0,0]}decodeMiddle(a,b,c){let d=this.decodeMiddleCounters;d[0]=0;d[1]=0;d[2]=0;d[3]=0;let e=a.getSize();b=b[1];for(var f=0;4>f&&b<e;f++){let e=H.decodeDigit(a,d,b,H.L_PATTERNS);c+=String.fromCharCode(48+e);for(var g of d)b+=g}b=H.findGuardPattern(a,b,!0,H.MIDDLE_PATTERN,Array(H.MIDDLE_PATTERN.length).fill(0))[1];for(g=0;4>g&&b<e;g++){f=H.decodeDigit(a,d,b,H.L_PATTERNS);c+=String.fromCharCode(48+f);for(let a of d)b+=a}return{rowOffset:b,
resultString:c}}getBarcodeFormat(){return t.EAN_8}}class Ta extends C{constructor(a){super();a=null==a?null:a.get(x.POSSIBLE_FORMATS);let b=[];null!=a&&(-1<a.indexOf(t.EAN_13)&&b.push(new Ra),-1<a.indexOf(t.EAN_8)&&b.push(new Sa));0===b.length&&(b.push(new Ra),b.push(new Sa));this.readers=b}decodeRow(a,b,c){for(let d of this.readers)try{return d.decodeRow(a,b,c)}catch(e){}throw new m;}reset(){for(let a of this.readers)a.reset()}}
class Ua extends C{constructor(a){super();this.readers=[];let b=a?a.get(x.POSSIBLE_FORMATS):null,c=a&&void 0!==a.get(x.ASSUME_CODE_39_CHECK_DIGIT);b&&((b.includes(t.EAN_13)||b.includes(t.EAN_8))&&this.readers.push(new Ta(a)),b.includes(t.CODE_39)&&this.readers.push(new Ia(c)),b.includes(t.CODE_128)&&this.readers.push(new D),b.includes(t.ITF)&&this.readers.push(new G),b.includes(t.RSS_14)&&this.readers.push(new F));0===this.readers.length&&(this.readers.push(new Ia),this.readers.push(new Ta(a)),this.readers.push(new D),
this.readers.push(new G),this.readers.push(new F))}decodeRow(a,b,c){for(let d=0;d<this.readers.length;d++)try{return this.readers[d].decodeRow(a,b,c)}catch(e){}throw new m;}reset(){this.readers.forEach((a)=>a.reset())}}
class Va{constructor(a,b){if(0===b.length)throw new k;this.field=a;a=b.length;if(1<a&&0===b[0]){let c=1;for(;c<a&&0===b[c];)c++;c===a?this.coefficients=Int32Array.from([0]):(this.coefficients=new Int32Array(a-c),ka.arraycopy(b,c,this.coefficients,0,this.coefficients.length))}else this.coefficients=b}getCoefficients(){return this.coefficients}getDegree(){return this.coefficients.length-1}isZero(){return 0===this.coefficients[0]}getCoefficient(a){return this.coefficients[this.coefficients.length-1-
a]}evaluateAt(a){if(0===a)return this.getCoefficient(0);let b=this.coefficients,c;if(1===a){c=0;for(let a=0,d=b.length;a!==d;a++)c=I.addOrSubtract(c,b[a]);return c}c=b[0];let d=b.length,e=this.field;for(let f=1;f<d;f++)c=I.addOrSubtract(e.multiply(a,c),b[f]);return c}addOrSubtract(a){if(!this.field.equals(a.field))throw new k("GenericGFPolys do not have same GenericGF field");if(this.isZero())return a;if(a.isZero())return this;let b=this.coefficients;a=a.coefficients;if(b.length>a.length){var c=b;
b=a;a=c}c=new Int32Array(a.length);let d=a.length-b.length;ka.arraycopy(a,0,c,0,d);for(let e=d;e<a.length;e++)c[e]=I.addOrSubtract(b[e-d],a[e]);return new Va(this.field,c)}multiply(a){if(!this.field.equals(a.field))throw new k("GenericGFPolys do not have same GenericGF field");if(this.isZero()||a.isZero())return this.field.getZero();let b=this.coefficients,c=b.length;a=a.coefficients;let d=a.length,e=new Int32Array(c+d-1),f=this.field;for(let g=0;g<c;g++){let c=b[g];for(let b=0;b<d;b++)e[g+b]=I.addOrSubtract(e[g+
b],f.multiply(c,a[b]))}return new Va(f,e)}multiplyScalar(a){if(0===a)return this.field.getZero();if(1===a)return this;let b=this.coefficients.length,c=this.field,d=new Int32Array(b),e=this.coefficients;for(let f=0;f<b;f++)d[f]=c.multiply(e[f],a);return new Va(c,d)}multiplyByMonomial(a,b){if(0>a)throw new k;if(0===b)return this.field.getZero();let c=this.coefficients,d=c.length;a=new Int32Array(d+a);let e=this.field;for(let f=0;f<d;f++)a[f]=e.multiply(c[f],b);return new Va(e,a)}divide(a){if(!this.field.equals(a.field))throw new k("GenericGFPolys do not have same GenericGF field");
if(a.isZero())throw new k("Divide by 0");let b=this.field,c=b.getZero(),d=this;var e=a.getCoefficient(a.getDegree());for(e=b.inverse(e);d.getDegree()>=a.getDegree()&&!d.isZero();){var f=d.getDegree()-a.getDegree();let g=b.multiply(d.getCoefficient(d.getDegree()),e),h=a.multiplyByMonomial(f,g);f=b.buildMonomial(f,g);c=c.addOrSubtract(f);d=d.addOrSubtract(h)}return[c,d]}toString(){let a="";for(let c=this.getDegree();0<=c;c--){var b=this.getCoefficient(c);if(0!==b){0>b?(a+=" - ",b=-b):0<a.length&&(a+=
" + ");if(0===c||1!==b)b=this.field.log(b),0===b?a+="1":1===b?a+="a":(a+="a^",a+=b);0!==c&&(1===c?a+="x":(a+="x^",a+=c))}}return a}}class Wa extends da{}
class I{constructor(a,b,c){this.primitive=a;this.size=b;this.generatorBase=c;c=new Int32Array(b);var d=1;for(let e=0;e<b;e++)c[e]=d,d*=2,d>=b&&(d^=a,d&=b-1);this.expTable=c;a=new Int32Array(b);for(d=0;d<b-1;d++)a[c[d]]=d;this.logTable=a;this.zero=new Va(this,Int32Array.from([0]));this.one=new Va(this,Int32Array.from([1]))}getZero(){return this.zero}getOne(){return this.one}buildMonomial(a,b){if(0>a)throw new k;if(0===b)return this.zero;a=new Int32Array(a+1);a[0]=b;return new Va(this,a)}static addOrSubtract(a,
b){return a^b}exp(a){return this.expTable[a]}log(a){if(0===a)throw new k;return this.logTable[a]}inverse(a){if(0===a)throw new Wa;return this.expTable[this.size-this.logTable[a]-1]}multiply(a,b){return 0===a||0===b?0:this.expTable[(this.logTable[a]+this.logTable[b])%(this.size-1)]}getSize(){return this.size}getGeneratorBase(){return this.generatorBase}toString(){return"GF(0x"+la.toHexString(this.primitive)+","+this.size+")"}equals(a){return a===this}}I.AZTEC_DATA_12=new I(4201,4096,1);
I.AZTEC_DATA_10=new I(1033,1024,1);I.AZTEC_DATA_6=new I(67,64,1);I.AZTEC_PARAM=new I(19,16,1);I.QR_CODE_FIELD_256=new I(285,256,0);I.DATA_MATRIX_FIELD_256=new I(301,256,1);I.AZTEC_DATA_8=null;I.MAXICODE_FIELD_64=null;class Xa extends da{}class Ya extends da{}
class Za{constructor(a){this.field=a}decode(a,b){let c=this.field;var d=new Va(c,a),e=new Int32Array(b),f=!0;for(let a=0;a<b;a++){let b=d.evaluateAt(c.exp(a+c.getGeneratorBase()));e[e.length-1-a]=b;0!==b&&(f=!1)}if(!f)for(d=new Va(c,e),b=this.runEuclideanAlgorithm(c.buildMonomial(b,1),d,b),d=b[1],b=this.findErrorLocations(b[0]),d=this.findErrorMagnitudes(d,b),e=0;e<b.length;e++){f=a.length-1-c.log(b[e]);if(0>f)throw new Xa("Bad error location");a[f]=I.addOrSubtract(a[f],d[e])}}runEuclideanAlgorithm(a,
b,c){if(a.getDegree()<b.getDegree()){var d=a;a=b;b=d}d=this.field;let e=d.getZero();for(var f=d.getOne();b.getDegree()>=(c/2|0);){var g=a;let c=e;a=b;e=f;if(a.isZero())throw new Xa("r_{i-1} was zero");b=g;f=d.getZero();g=a.getCoefficient(a.getDegree());for(g=d.inverse(g);b.getDegree()>=a.getDegree()&&!b.isZero();){let c=b.getDegree()-a.getDegree(),e=d.multiply(b.getCoefficient(b.getDegree()),g);f=f.addOrSubtract(d.buildMonomial(c,e));b=b.addOrSubtract(a.multiplyByMonomial(c,e))}f=f.multiply(e).addOrSubtract(c);
if(b.getDegree()>=a.getDegree())throw new Ya("Division algorithm failed to reduce polynomial?");}c=f.getCoefficient(0);if(0===c)throw new Xa("sigmaTilde(0) was zero");c=d.inverse(c);d=f.multiplyScalar(c);c=b.multiplyScalar(c);return[d,c]}findErrorLocations(a){let b=a.getDegree();if(1===b)return Int32Array.from([a.getCoefficient(1)]);let c=new Int32Array(b),d=0,e=this.field;for(let f=1;f<e.getSize()&&d<b;f++)0===a.evaluateAt(f)&&(c[d]=e.inverse(f),d++);if(d!==b)throw new Xa("Error locator degree does not match number of roots");
return c}findErrorMagnitudes(a,b){let c=b.length,d=new Int32Array(c),e=this.field;for(let f=0;f<c;f++){let g=e.inverse(b[f]),h=1;for(let a=0;a<c;a++)if(f!==a){let c=e.multiply(b[a],g);h=e.multiply(h,0===(c&1)?c|1:c&-2)}d[f]=e.multiply(a.evaluateAt(g),e.inverse(h));0!==e.getGeneratorBase()&&(d[f]=e.multiply(d[f],g))}return d}}class J{constructor(a,b,c){this.ecCodewords=a;this.ecBlocks=[b];c&&this.ecBlocks.push(c)}getECCodewords(){return this.ecCodewords}getECBlocks(){return this.ecBlocks}}
class K{constructor(a,b){this.count=a;this.dataCodewords=b}getCount(){return this.count}getDataCodewords(){return this.dataCodewords}}
class L{constructor(a,b,c,d,e,f){this.versionNumber=a;this.symbolSizeRows=b;this.symbolSizeColumns=c;this.dataRegionSizeRows=d;this.dataRegionSizeColumns=e;this.ecBlocks=f;a=0;b=f.getECCodewords();f=f.getECBlocks();for(let c of f)a+=c.getCount()*(c.getDataCodewords()+b);this.totalCodewords=a}getVersionNumber(){return this.versionNumber}getSymbolSizeRows(){return this.symbolSizeRows}getSymbolSizeColumns(){return this.symbolSizeColumns}getDataRegionSizeRows(){return this.dataRegionSizeRows}getDataRegionSizeColumns(){return this.dataRegionSizeColumns}getTotalCodewords(){return this.totalCodewords}getECBlocks(){return this.ecBlocks}static getVersionForDimensions(a,b){if(0!==
(a&1)||0!==(b&1))throw new p;for(let c of L.VERSIONS)if(c.symbolSizeRows===a&&c.symbolSizeColumns===b)return c;throw new p;}toString(){return""+this.versionNumber}static buildVersions(){return[new L(1,10,10,8,8,new J(5,new K(1,3))),new L(2,12,12,10,10,new J(7,new K(1,5))),new L(3,14,14,12,12,new J(10,new K(1,8))),new L(4,16,16,14,14,new J(12,new K(1,12))),new L(5,18,18,16,16,new J(14,new K(1,18))),new L(6,20,20,18,18,new J(18,new K(1,22))),new L(7,22,22,20,20,new J(20,new K(1,30))),new L(8,24,24,
22,22,new J(24,new K(1,36))),new L(9,26,26,24,24,new J(28,new K(1,44))),new L(10,32,32,14,14,new J(36,new K(1,62))),new L(11,36,36,16,16,new J(42,new K(1,86))),new L(12,40,40,18,18,new J(48,new K(1,114))),new L(13,44,44,20,20,new J(56,new K(1,144))),new L(14,48,48,22,22,new J(68,new K(1,174))),new L(15,52,52,24,24,new J(42,new K(2,102))),new L(16,64,64,14,14,new J(56,new K(2,140))),new L(17,72,72,16,16,new J(36,new K(4,92))),new L(18,80,80,18,18,new J(48,new K(4,114))),new L(19,88,88,20,20,new J(56,
new K(4,144))),new L(20,96,96,22,22,new J(68,new K(4,174))),new L(21,104,104,24,24,new J(56,new K(6,136))),new L(22,120,120,18,18,new J(68,new K(6,175))),new L(23,132,132,20,20,new J(62,new K(8,163))),new L(24,144,144,22,22,new J(62,new K(8,156),new K(2,155))),new L(25,8,18,6,16,new J(7,new K(1,5))),new L(26,8,32,6,14,new J(11,new K(1,10))),new L(27,12,26,10,24,new J(14,new K(1,16))),new L(28,12,36,10,16,new J(18,new K(1,22))),new L(29,16,36,14,16,new J(24,new K(1,32))),new L(30,16,48,14,22,new J(28,
new K(1,49)))]}}L.VERSIONS=L.buildVersions();
class $a{constructor(a){let b=a.getHeight();if(8>b||144<b||0!==(b&1))throw new p;this.version=$a.readVersion(a);this.mappingBitMatrix=this.extractDataRegion(a);this.readMappingMatrix=new pa(this.mappingBitMatrix.getWidth(),this.mappingBitMatrix.getHeight())}getVersion(){return this.version}static readVersion(a){let b=a.getHeight();a=a.getWidth();return L.getVersionForDimensions(b,a)}readCodewords(){let a=new Int8Array(this.version.getTotalCodewords()),b=0,c=4,d=0,e=this.mappingBitMatrix.getHeight(),
f=this.mappingBitMatrix.getWidth(),g=!1,h=!1,l=!1,r=!1;do if(c!==e||0!==d||g)if(c!==e-2||0!==d||0===(f&3)||h)if(c!==e+4||2!==d||0!==(f&7)||l)if(c!==e-2||0!==d||4!==(f&7)||r){do c<e&&0<=d&&!this.readMappingMatrix.get(d,c)&&(a[b++]=this.readUtah(c,d,e,f)&255),c-=2,d+=2;while(0<=c&&d<f);c+=1;d+=3;do 0<=c&&d<f&&!this.readMappingMatrix.get(d,c)&&(a[b++]=this.readUtah(c,d,e,f)&255),c+=2,d-=2;while(c<e&&0<=d);c+=3;d+=1}else a[b++]=this.readCorner4(e,f)&255,c-=2,d+=2,r=!0;else a[b++]=this.readCorner3(e,f)&
255,c-=2,d+=2,l=!0;else a[b++]=this.readCorner2(e,f)&255,c-=2,d+=2,h=!0;else a[b++]=this.readCorner1(e,f)&255,c-=2,d+=2,g=!0;while(c<e||d<f);if(b!==this.version.getTotalCodewords())throw new p;return a}readModule(a,b,c,d){0>a&&(a+=c,b+=4-(c+4&7));0>b&&(b+=d,a+=4-(d+4&7));this.readMappingMatrix.set(b,a);return this.mappingBitMatrix.get(b,a)}readUtah(a,b,c,d){let e=0;this.readModule(a-2,b-2,c,d)&&(e|=1);e<<=1;this.readModule(a-2,b-1,c,d)&&(e|=1);e<<=1;this.readModule(a-1,b-2,c,d)&&(e|=1);e<<=1;this.readModule(a-
1,b-1,c,d)&&(e|=1);e<<=1;this.readModule(a-1,b,c,d)&&(e|=1);e<<=1;this.readModule(a,b-2,c,d)&&(e|=1);e<<=1;this.readModule(a,b-1,c,d)&&(e|=1);e<<=1;this.readModule(a,b,c,d)&&(e|=1);return e}readCorner1(a,b){let c=0;this.readModule(a-1,0,a,b)&&(c|=1);c<<=1;this.readModule(a-1,1,a,b)&&(c|=1);c<<=1;this.readModule(a-1,2,a,b)&&(c|=1);c<<=1;this.readModule(0,b-2,a,b)&&(c|=1);c<<=1;this.readModule(0,b-1,a,b)&&(c|=1);c<<=1;this.readModule(1,b-1,a,b)&&(c|=1);c<<=1;this.readModule(2,b-1,a,b)&&(c|=1);c<<=1;
this.readModule(3,b-1,a,b)&&(c|=1);return c}readCorner2(a,b){let c=0;this.readModule(a-3,0,a,b)&&(c|=1);c<<=1;this.readModule(a-2,0,a,b)&&(c|=1);c<<=1;this.readModule(a-1,0,a,b)&&(c|=1);c<<=1;this.readModule(0,b-4,a,b)&&(c|=1);c<<=1;this.readModule(0,b-3,a,b)&&(c|=1);c<<=1;this.readModule(0,b-2,a,b)&&(c|=1);c<<=1;this.readModule(0,b-1,a,b)&&(c|=1);c<<=1;this.readModule(1,b-1,a,b)&&(c|=1);return c}readCorner3(a,b){let c=0;this.readModule(a-1,0,a,b)&&(c|=1);c<<=1;this.readModule(a-1,b-1,a,b)&&(c|=1);
c<<=1;this.readModule(0,b-3,a,b)&&(c|=1);c<<=1;this.readModule(0,b-2,a,b)&&(c|=1);c<<=1;this.readModule(0,b-1,a,b)&&(c|=1);c<<=1;this.readModule(1,b-3,a,b)&&(c|=1);c<<=1;this.readModule(1,b-2,a,b)&&(c|=1);c<<=1;this.readModule(1,b-1,a,b)&&(c|=1);return c}readCorner4(a,b){let c=0;this.readModule(a-3,0,a,b)&&(c|=1);c<<=1;this.readModule(a-2,0,a,b)&&(c|=1);c<<=1;this.readModule(a-1,0,a,b)&&(c|=1);c<<=1;this.readModule(0,b-2,a,b)&&(c|=1);c<<=1;this.readModule(0,b-1,a,b)&&(c|=1);c<<=1;this.readModule(1,
b-1,a,b)&&(c|=1);c<<=1;this.readModule(2,b-1,a,b)&&(c|=1);c<<=1;this.readModule(3,b-1,a,b)&&(c|=1);return c}extractDataRegion(a){var b=this.version.getSymbolSizeRows(),c=this.version.getSymbolSizeColumns();if(a.getHeight()!==b)throw new k("Dimension of bitMatrix must match the version size");let d=this.version.getDataRegionSizeRows(),e=this.version.getDataRegionSizeColumns();b=b/d|0;c=c/e|0;let f=new pa(c*e,b*d);for(let g=0;g<b;++g){let b=g*d;for(let h=0;h<c;++h){let c=h*e;for(let l=0;l<d;++l){let r=
g*(d+2)+1+l,u=b+l;for(let b=0;b<e;++b)a.get(h*(e+2)+1+b,r)&&f.set(c+b,u)}}}return f}}
class ab{constructor(a,b){this.numDataCodewords=a;this.codewords=b}static getDataBlocks(a,b){var c=b.getECBlocks(),d=0,e=c.getECBlocks();for(var f of e)d+=f.getCount();d=Array(d);f=0;for(var g of e)for(e=0;e<g.getCount();e++){var h=g.getDataCodewords(),l=c.getECCodewords()+h;d[f++]=new ab(h,new Uint8Array(l))}g=d[0].codewords.length-c.getECCodewords();e=g-1;c=0;for(h=0;h<e;h++)for(l=0;l<f;l++)d[l].codewords[h]=a[c++];e=(b=24===b.getVersionNumber())?8:f;for(h=0;h<e;h++)d[h].codewords[g-1]=a[c++];for(e=
d[0].codewords.length;g<e;g++)for(h=0;h<f;h++)l=b?(h+8)%f:h,d[l].codewords[b&&7<l?g-1:g]=a[c++];if(c!==a.length)throw new k;return d}getNumDataCodewords(){return this.numDataCodewords}getCodewords(){return this.codewords}}
class bb{constructor(a,b,c,d,e=-1,f=-1){this.rawBytes=a;this.text=b;this.byteSegments=c;this.ecLevel=d;this.structuredAppendSequenceNumber=e;this.structuredAppendParity=f;this.numBits=void 0===a||null===a?0:8*a.length}getRawBytes(){return this.rawBytes}getNumBits(){return this.numBits}setNumBits(a){this.numBits=a}getText(){return this.text}getByteSegments(){return this.byteSegments}getECLevel(){return this.ecLevel}getErrorsCorrected(){return this.errorsCorrected}setErrorsCorrected(a){this.errorsCorrected=
a}getErasures(){return this.erasures}setErasures(a){this.erasures=a}getOther(){return this.other}setOther(a){this.other=a}hasStructuredAppend(){return 0<=this.structuredAppendParity&&0<=this.structuredAppendSequenceNumber}getStructuredAppendParity(){return this.structuredAppendParity}getStructuredAppendSequenceNumber(){return this.structuredAppendSequenceNumber}}
class cb{constructor(a){this.bytes=a;this.bitOffset=this.byteOffset=0}getBitOffset(){return this.bitOffset}getByteOffset(){return this.byteOffset}readBits(a){if(1>a||32<a||a>this.available())throw new k(""+a);var b=0;let c=this.bitOffset,d=this.byteOffset,e=this.bytes;if(0<c){b=8-c;var f=a<b?a:b;b-=f;b=(e[d]&255>>8-f<<b)>>b;a-=f;c+=f;8===c&&(c=0,d++)}if(0<a){for(;8<=a;)b=b<<8|e[d]&255,d++,a-=8;0<a&&(f=8-a,b=b<<a|(e[d]&255>>f<<f)>>f,c+=a)}this.bitOffset=c;this.byteOffset=d;return b}available(){return 8*
(this.bytes.length-this.byteOffset)-this.bitOffset}}var M,N=M||(M={});N[N.Cp437=0]="Cp437";N[N.ISO8859_1=1]="ISO8859_1";N[N.ISO8859_2=2]="ISO8859_2";N[N.ISO8859_3=3]="ISO8859_3";N[N.ISO8859_4=4]="ISO8859_4";N[N.ISO8859_5=5]="ISO8859_5";N[N.ISO8859_6=6]="ISO8859_6";N[N.ISO8859_7=7]="ISO8859_7";N[N.ISO8859_8=8]="ISO8859_8";N[N.ISO8859_9=9]="ISO8859_9";N[N.ISO8859_10=10]="ISO8859_10";N[N.ISO8859_11=11]="ISO8859_11";N[N.ISO8859_13=12]="ISO8859_13";N[N.ISO8859_14=13]="ISO8859_14";N[N.ISO8859_15=14]="ISO8859_15";
N[N.ISO8859_16=15]="ISO8859_16";N[N.SJIS=16]="SJIS";N[N.Cp1250=17]="Cp1250";N[N.Cp1251=18]="Cp1251";N[N.Cp1252=19]="Cp1252";N[N.Cp1256=20]="Cp1256";N[N.UnicodeBigUnmarked=21]="UnicodeBigUnmarked";N[N.UTF8=22]="UTF8";N[N.ASCII=23]="ASCII";N[N.Big5=24]="Big5";N[N.GB18030=25]="GB18030";N[N.EUC_KR=26]="EUC_KR";
class O{constructor(a,b,c,...d){this.valueIdentifier=a;this.name=c;this.values="number"===typeof b?Int32Array.from([b]):b;this.otherEncodingNames=d;O.VALUE_IDENTIFIER_TO_ECI.set(a,this);O.NAME_TO_ECI.set(c,this);a=this.values;for(let b=0,c=a.length;b!==c;b++)O.VALUES_TO_ECI.set(a[b],this);for(let a of d)O.NAME_TO_ECI.set(a,this)}getValueIdentifier(){return this.valueIdentifier}getName(){return this.name}getValue(){return this.values[0]}static getCharacterSetECIByValue(a){if(0>a||900<=a)throw new p("incorect value");
a=O.VALUES_TO_ECI.get(a);if(void 0===a)throw new p("incorect value");return a}static getCharacterSetECIByName(a){a=O.NAME_TO_ECI.get(a);if(void 0===a)throw new p("incorect value");return a}equals(a){return a instanceof O?this.getName()===a.getName():!1}}O.VALUE_IDENTIFIER_TO_ECI=new Map;O.VALUES_TO_ECI=new Map;O.NAME_TO_ECI=new Map;O.Cp437=new O(M.Cp437,Int32Array.from([0,2]),"Cp437");O.ISO8859_1=new O(M.ISO8859_1,Int32Array.from([1,3]),"ISO-8859-1","ISO88591","ISO8859_1");
O.ISO8859_2=new O(M.ISO8859_2,4,"ISO-8859-2","ISO88592","ISO8859_2");O.ISO8859_3=new O(M.ISO8859_3,5,"ISO-8859-3","ISO88593","ISO8859_3");O.ISO8859_4=new O(M.ISO8859_4,6,"ISO-8859-4","ISO88594","ISO8859_4");O.ISO8859_5=new O(M.ISO8859_5,7,"ISO-8859-5","ISO88595","ISO8859_5");O.ISO8859_6=new O(M.ISO8859_6,8,"ISO-8859-6","ISO88596","ISO8859_6");O.ISO8859_7=new O(M.ISO8859_7,9,"ISO-8859-7","ISO88597","ISO8859_7");O.ISO8859_8=new O(M.ISO8859_8,10,"ISO-8859-8","ISO88598","ISO8859_8");
O.ISO8859_9=new O(M.ISO8859_9,11,"ISO-8859-9","ISO88599","ISO8859_9");O.ISO8859_10=new O(M.ISO8859_10,12,"ISO-8859-10","ISO885910","ISO8859_10");O.ISO8859_11=new O(M.ISO8859_11,13,"ISO-8859-11","ISO885911","ISO8859_11");O.ISO8859_13=new O(M.ISO8859_13,15,"ISO-8859-13","ISO885913","ISO8859_13");O.ISO8859_14=new O(M.ISO8859_14,16,"ISO-8859-14","ISO885914","ISO8859_14");O.ISO8859_15=new O(M.ISO8859_15,17,"ISO-8859-15","ISO885915","ISO8859_15");
O.ISO8859_16=new O(M.ISO8859_16,18,"ISO-8859-16","ISO885916","ISO8859_16");O.SJIS=new O(M.SJIS,20,"SJIS","Shift_JIS");O.Cp1250=new O(M.Cp1250,21,"Cp1250","windows-1250");O.Cp1251=new O(M.Cp1251,22,"Cp1251","windows-1251");O.Cp1252=new O(M.Cp1252,23,"Cp1252","windows-1252");O.Cp1256=new O(M.Cp1256,24,"Cp1256","windows-1256");O.UnicodeBigUnmarked=new O(M.UnicodeBigUnmarked,25,"UnicodeBigUnmarked","UTF-16BE","UnicodeBig");O.UTF8=new O(M.UTF8,26,"UTF8","UTF-8");
O.ASCII=new O(M.ASCII,Int32Array.from([27,170]),"ASCII","US-ASCII");O.Big5=new O(M.Big5,28,"Big5");O.GB18030=new O(M.GB18030,29,"GB18030","GB2312","EUC_CN","GBK");O.EUC_KR=new O(M.EUC_KR,30,"EUC_KR","EUC-KR");
class db{static decode(a,b){b=this.encodingName(b);return"undefined"===typeof TextDecoder?this.decodeFallback(a,b):(new TextDecoder(b)).decode(a)}static encode(a,b){return db.isBrowser()?"undefined"===typeof TextEncoder?this.encodeFallback(a):(new TextEncoder).encode(a):(new TextEncoder(this.encodingName(b),{NONSTANDARD_allowLegacyEncoding:!0})).encode(a)}static isBrowser(){return"undefined"!==typeof window&&"[object Window]"==={}.toString.call(window)}static encodingName(a){return"string"===typeof a?
a:a.getName()}static encodingCharacterSet(a){return O.getCharacterSetECIByName(this.encodingName(a))}static decodeFallback(a,b){var c=this.encodingCharacterSet(b);if(c.equals(O.UTF8)||c.equals(O.ISO8859_1)||c.equals(O.ASCII)){b="";for(let d=0,e=a.length;d<e;d++)c=a[d].toString(16),2>c.length&&(c="0"+c),b+="%"+c;return decodeURIComponent(b)}if(c.equals(O.UnicodeBigUnmarked))return String.fromCharCode.apply(null,new Uint16Array(a.buffer));throw new sa(`Encoding ${this.encodingName(b)} not supported by fallback.`);
}static encodeFallback(a){a=btoa(unescape(encodeURIComponent(a))).split("");let b=[];for(let c=0;c<a.length;c++)b.push(a[c].charCodeAt(0));return new Uint8Array(b)}}var eb,fb=eb||(eb={});fb[fb.PAD_ENCODE=0]="PAD_ENCODE";fb[fb.ASCII_ENCODE=1]="ASCII_ENCODE";fb[fb.C40_ENCODE=2]="C40_ENCODE";fb[fb.TEXT_ENCODE=3]="TEXT_ENCODE";fb[fb.ANSIX12_ENCODE=4]="ANSIX12_ENCODE";fb[fb.EDIFACT_ENCODE=5]="EDIFACT_ENCODE";fb[fb.BASE256_ENCODE=6]="BASE256_ENCODE";
class gb{static decode(a){let b=new cb(a),c=new oa,d=new oa,e=[],f=eb.ASCII_ENCODE;do if(f===eb.ASCII_ENCODE)f=this.decodeAsciiSegment(b,c,d);else{switch(f){case eb.C40_ENCODE:this.decodeC40Segment(b,c);break;case eb.TEXT_ENCODE:this.decodeTextSegment(b,c);break;case eb.ANSIX12_ENCODE:this.decodeAnsiX12Segment(b,c);break;case eb.EDIFACT_ENCODE:this.decodeEdifactSegment(b,c);break;case eb.BASE256_ENCODE:this.decodeBase256Segment(b,c,e);break;default:throw new p;}f=eb.ASCII_ENCODE}while(f!==eb.PAD_ENCODE&&
0<b.available());0<d.length()&&c.append(d.toString());return new bb(a,c.toString(),0===e.length?null:e,null)}static decodeAsciiSegment(a,b,c){let d=!1;do{var e=a.readBits(8);if(0===e)throw new p;if(128>=e){d&&(e+=128);b.append(String.fromCharCode(e-1));break}else{if(129===e)return eb.PAD_ENCODE;if(229>=e)e-=130,10>e&&b.append("0"),b.append(""+e);else switch(e){case 230:return eb.C40_ENCODE;case 231:return eb.BASE256_ENCODE;case 232:b.append(String.fromCharCode(29));break;case 233:case 234:break;case 235:d=
!0;break;case 236:b.append("[)>\u001e05\u001d");c.insert(0,"\u001e\u0004");break;case 237:b.append("[)>\u001e06\u001d");c.insert(0,"\u001e\u0004");break;case 238:return eb.ANSIX12_ENCODE;case 239:return eb.TEXT_ENCODE;case 240:return eb.EDIFACT_ENCODE;case 241:break;default:if(254!==e||0!==a.available())throw new p;}}}while(0<a.available());return eb.ASCII_ENCODE}static decodeC40Segment(a,b){let c=!1,d=[];var e=0;do{if(8===a.available())break;var f=a.readBits(8);if(254===f)break;this.parseTwoBytes(f,
a.readBits(8),d);for(f=0;3>f;f++){var g=d[f];switch(e){case 0:if(3>g)e=g+1;else if(g<this.C40_BASIC_SET_CHARS.length)g=this.C40_BASIC_SET_CHARS[g],c?(b.append(String.fromCharCode(g.charCodeAt(0)+128)),c=!1):b.append(g);else throw new p;break;case 1:c?(b.append(String.fromCharCode(g+128)),c=!1):b.append(String.fromCharCode(g));e=0;break;case 2:if(g<this.C40_SHIFT2_SET_CHARS.length)e=this.C40_SHIFT2_SET_CHARS[g],c?(b.append(String.fromCharCode(e.charCodeAt(0)+128)),c=!1):b.append(e);else switch(g){case 27:b.append(String.fromCharCode(29));
break;case 30:c=!0;break;default:throw new p;}e=0;break;case 3:c?(b.append(String.fromCharCode(g+224)),c=!1):b.append(String.fromCharCode(g+96));e=0;break;default:throw new p;}}}while(0<a.available())}static decodeTextSegment(a,b){let c=!1,d=[];var e=0;do{if(8===a.available())break;var f=a.readBits(8);if(254===f)break;this.parseTwoBytes(f,a.readBits(8),d);for(f=0;3>f;f++){var g=d[f];switch(e){case 0:if(3>g)e=g+1;else if(g<this.TEXT_BASIC_SET_CHARS.length)g=this.TEXT_BASIC_SET_CHARS[g],c?(b.append(String.fromCharCode(g.charCodeAt(0)+
128)),c=!1):b.append(g);else throw new p;break;case 1:c?(b.append(String.fromCharCode(g+128)),c=!1):b.append(String.fromCharCode(g));e=0;break;case 2:if(g<this.TEXT_SHIFT2_SET_CHARS.length)e=this.TEXT_SHIFT2_SET_CHARS[g],c?(b.append(String.fromCharCode(e.charCodeAt(0)+128)),c=!1):b.append(e);else switch(g){case 27:b.append(String.fromCharCode(29));break;case 30:c=!0;break;default:throw new p;}e=0;break;case 3:if(g<this.TEXT_SHIFT3_SET_CHARS.length)e=this.TEXT_SHIFT3_SET_CHARS[g],c?(b.append(String.fromCharCode(e.charCodeAt(0)+
128)),c=!1):b.append(e),e=0;else throw new p;break;default:throw new p;}}}while(0<a.available())}static decodeAnsiX12Segment(a,b){let c=[];do{if(8===a.available())break;var d=a.readBits(8);if(254===d)break;this.parseTwoBytes(d,a.readBits(8),c);for(d=0;3>d;d++){let a=c[d];switch(a){case 0:b.append("\r");break;case 1:b.append("*");break;case 2:b.append(">");break;case 3:b.append(" ");break;default:if(14>a)b.append(String.fromCharCode(a+44));else if(40>a)b.append(String.fromCharCode(a+51));else throw new p;
}}}while(0<a.available())}static parseTwoBytes(a,b,c){a=(a<<8)+b-1;b=Math.floor(a/1600);c[0]=b;a-=1600*b;b=Math.floor(a/40);c[1]=b;c[2]=a-40*b}static decodeEdifactSegment(a,b){do{if(16>=a.available())break;for(let c=0;4>c;c++){let c=a.readBits(6);if(31===c){b=8-a.getBitOffset();8!==b&&a.readBits(b);return}0===(c&32)&&(c|=64);b.append(String.fromCharCode(c))}}while(0<a.available())}static decodeBase256Segment(a,b,c){let d=1+a.getByteOffset();var e=this.unrandomize255State(a.readBits(8),d++);e=0===
e?a.available()/8|0:250>e?e:250*(e-249)+this.unrandomize255State(a.readBits(8),d++);if(0>e)throw new p;let f=new Uint8Array(e);for(let b=0;b<e;b++){if(8>a.available())throw new p;f[b]=this.unrandomize255State(a.readBits(8),d++)}c.push(f);try{b.append(db.decode(f,P.ISO88591))}catch(g){throw new Ya("Platform does not support required encoding: "+g.message);}}static unrandomize255State(a,b){a-=149*b%255+1;return 0<=a?a:a+256}}gb.C40_BASIC_SET_CHARS="*** 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ".split("");
gb.C40_SHIFT2_SET_CHARS="!\"#$%&'()*+,-./:;<=>?@[\\]^_".split("");gb.TEXT_BASIC_SET_CHARS="*** 0123456789abcdefghijklmnopqrstuvwxyz".split("");gb.TEXT_SHIFT2_SET_CHARS=null;gb.TEXT_SHIFT3_SET_CHARS=["`","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","{","|","}","~",String.fromCharCode(127)];
class hb{constructor(){this.rsDecoder=new Za(I.DATA_MATRIX_FIELD_256)}decode(a){var b=new $a(a);a=b.getVersion();b=b.readCodewords();a=ab.getDataBlocks(b,a);b=0;for(var c of a)b+=c.getNumDataCodewords();c=new Uint8Array(b);b=a.length;for(let e=0;e<b;e++){var d=a[e];let f=d.getCodewords();d=d.getNumDataCodewords();this.correctErrors(f,d);for(let a=0;a<d;a++)c[a*b+e]=f[a]}return gb.decode(c)}correctErrors(a,b){let c=new Int32Array(a);try{this.rsDecoder.decode(c,a.length-b)}catch(d){throw new ia;}for(let d=
0;d<b;d++)a[d]=c[d]}}class ib{constructor(a,b){this.bits=a;this.points=b}getBits(){return this.bits}getPoints(){return this.points}}
class jb{static checkAndNudgePoints(a,b){let c=a.getWidth();a=a.getHeight();let d=!0;for(var e=0;e<b.length&&d;e+=2){var f=Math.floor(b[e]),g=Math.floor(b[e+1]);if(-1>f||f>c||-1>g||g>a)throw new m;d=!1;-1===f?(b[e]=0,d=!0):f===c&&(b[e]=c-1,d=!0);-1===g?(b[e+1]=0,d=!0):g===a&&(b[e+1]=a-1,d=!0)}d=!0;for(e=b.length-2;0<=e&&d;e-=2){f=Math.floor(b[e]);g=Math.floor(b[e+1]);if(-1>f||f>c||-1>g||g>a)throw new m;d=!1;-1===f?(b[e]=0,d=!0):f===c&&(b[e]=c-1,d=!0);-1===g?(b[e+1]=0,d=!0):g===a&&(b[e+1]=a-1,d=!0)}}}
class kb{constructor(a,b,c,d,e,f,g,h,l){this.a11=a;this.a21=b;this.a31=c;this.a12=d;this.a22=e;this.a32=f;this.a13=g;this.a23=h;this.a33=l}static quadrilateralToQuadrilateral(a,b,c,d,e,f,g,h,l,r,u,v,A,E,T,B){a=kb.quadrilateralToSquare(a,b,c,d,e,f,g,h);return kb.squareToQuadrilateral(l,r,u,v,A,E,T,B).times(a)}transformPoints(a){let b=a.length,c=this.a11,d=this.a12,e=this.a13,f=this.a21,g=this.a22,h=this.a23,l=this.a31,r=this.a32,u=this.a33;for(let v=0;v<b;v+=2){let b=a[v],E=a[v+1],T=e*b+h*E+u;a[v]=
(c*b+f*E+l)/T;a[v+1]=(d*b+g*E+r)/T}}transformPointsWithValues(a,b){let c=this.a11,d=this.a12,e=this.a13,f=this.a21,g=this.a22,h=this.a23,l=this.a31,r=this.a32,u=this.a33,v=a.length;for(let A=0;A<v;A++){let v=a[A],T=b[A],B=e*v+h*T+u;a[A]=(c*v+f*T+l)/B;b[A]=(d*v+g*T+r)/B}}static squareToQuadrilateral(a,b,c,d,e,f,g,h){var l=a-c+e-g;let r=b-d+f-h;if(0===l&&0===r)return new kb(c-a,e-c,a,d-b,f-d,b,0,0,1);{let v=c-e;var u=g-e;e=d-f;let A=h-f;f=v*A-u*e;u=(l*A-u*r)/f;l=(v*r-l*e)/f;return new kb(c-a+u*c,g-
a+l*g,a,d-b+u*d,h-b+l*h,b,u,l,1)}}static quadrilateralToSquare(a,b,c,d,e,f,g,h){return kb.squareToQuadrilateral(a,b,c,d,e,f,g,h).buildAdjoint()}buildAdjoint(){return new kb(this.a22*this.a33-this.a23*this.a32,this.a23*this.a31-this.a21*this.a33,this.a21*this.a32-this.a22*this.a31,this.a13*this.a32-this.a12*this.a33,this.a11*this.a33-this.a13*this.a31,this.a12*this.a31-this.a11*this.a32,this.a12*this.a23-this.a13*this.a22,this.a13*this.a21-this.a11*this.a23,this.a11*this.a22-this.a12*this.a21)}times(a){return new kb(this.a11*
a.a11+this.a21*a.a12+this.a31*a.a13,this.a11*a.a21+this.a21*a.a22+this.a31*a.a23,this.a11*a.a31+this.a21*a.a32+this.a31*a.a33,this.a12*a.a11+this.a22*a.a12+this.a32*a.a13,this.a12*a.a21+this.a22*a.a22+this.a32*a.a23,this.a12*a.a31+this.a22*a.a32+this.a32*a.a33,this.a13*a.a11+this.a23*a.a12+this.a33*a.a13,this.a13*a.a21+this.a23*a.a22+this.a33*a.a23,this.a13*a.a31+this.a23*a.a32+this.a33*a.a33)}}
class lb extends jb{sampleGrid(a,b,c,d,e,f,g,h,l,r,u,v,A,E,T,B,Fa,ya,qa){d=kb.quadrilateralToQuadrilateral(d,e,f,g,h,l,r,u,v,A,E,T,B,Fa,ya,qa);return this.sampleGridWithTransform(a,b,c,d)}sampleGridWithTransform(a,b,c,d){if(0>=b||0>=c)throw new m;let e=new pa(b,c);b=new Float32Array(2*b);for(let g=0;g<c;g++){let c=b.length;var f=g+.5;for(let a=0;a<c;a+=2)b[a]=a/2+.5,b[a+1]=f;d.transformPoints(b);jb.checkAndNudgePoints(a,b);try{for(f=0;f<c;f+=2)a.get(Math.floor(b[f]),Math.floor(b[f+1]))&&e.set(f/2,
g)}catch(l){throw new m;}}return e}}class mb{static setGridSampler(a){mb.gridSampler=a}static getInstance(){return mb.gridSampler}}mb.gridSampler=new lb;
class Q{constructor(a,b,c,d){this.image=a;this.height=a.getHeight();this.width=a.getWidth();if(void 0===b||null===b)b=Q.INIT_SIZE;if(void 0===c||null===c)c=a.getWidth()/2|0;if(void 0===d||null===d)d=a.getHeight()/2|0;a=b/2|0;this.leftInit=c-a;this.rightInit=c+a;this.upInit=d-a;this.downInit=d+a;if(0>this.upInit||0>this.leftInit||this.downInit>=this.height||this.rightInit>=this.width)throw new m;}detect(){var a=this.leftInit;let b=this.rightInit;var c=this.upInit;let d=this.downInit;var e=!1,f=!0,
g=!1,h=!1;let l=!1,r=!1,u=!1,v=this.width,A=this.height;for(;f;){f=!1;for(var E=!0;(E||!h)&&b<v;)(E=this.containsBlackPoint(c,d,b,!1))?(b++,h=f=!0):h||b++;if(b>=v){e=!0;break}for(E=!0;(E||!l)&&d<A;)(E=this.containsBlackPoint(a,b,d,!0))?(d++,l=f=!0):l||d++;if(d>=A){e=!0;break}for(E=!0;(E||!r)&&0<=a;)(E=this.containsBlackPoint(c,d,a,!1))?(a--,r=f=!0):r||a--;if(0>a){e=!0;break}for(E=!0;(E||!u)&&0<=c;)(E=this.containsBlackPoint(a,b,c,!0))?(c--,u=f=!0):u||c--;if(0>c){e=!0;break}f&&(g=!0)}if(!e&&g){e=b-
a;f=null;for(g=1;null===f&&g<e;g++)f=this.getBlackPointOnSegment(a,d-g,a+g,d);if(null==f)throw new m;g=null;for(h=1;null===g&&h<e;h++)g=this.getBlackPointOnSegment(a,c+h,a+h,c);if(null==g)throw new m;a=null;for(h=1;null===a&&h<e;h++)a=this.getBlackPointOnSegment(b,c+h,b-h,c);if(null==a)throw new m;c=null;for(h=1;null===c&&h<e;h++)c=this.getBlackPointOnSegment(b,d-h,b-h,d);if(null==c)throw new m;return this.centerEdges(c,f,a,g)}throw new m;}getBlackPointOnSegment(a,b,c,d){let e=Ea.round(Ea.distance(a,
b,c,d));c=(c-a)/e;d=(d-b)/e;let f=this.image;for(let g=0;g<e;g++){let e=Ea.round(a+g*c),l=Ea.round(b+g*d);if(f.get(e,l))return new z(e,l)}return null}centerEdges(a,b,c,d){let e=a.getX();a=a.getY();let f=b.getX();b=b.getY();let g=c.getX();c=c.getY();let h=d.getX();d=d.getY();return e<this.width/2?[new z(h-Q.CORR,d+Q.CORR),new z(f+Q.CORR,b+Q.CORR),new z(g-Q.CORR,c-Q.CORR),new z(e+Q.CORR,a-Q.CORR)]:[new z(h+Q.CORR,d+Q.CORR),new z(f+Q.CORR,b-Q.CORR),new z(g-Q.CORR,c+Q.CORR),new z(e-Q.CORR,a-Q.CORR)]}containsBlackPoint(a,
b,c,d){let e=this.image;if(d)for(;a<=b;a++){if(e.get(a,c))return!0}else for(;a<=b;a++)if(e.get(c,a))return!0;return!1}}Q.INIT_SIZE=10;Q.CORR=1;
class nb{constructor(a){this.image=a;this.rectangleDetector=new Q(a)}detect(){var a=this.rectangleDetector.detect(),b=a[0],c=a[1],d=a[2],e=a[3],f=[];f.push(this.transitionsBetween(b,c));f.push(this.transitionsBetween(b,d));f.push(this.transitionsBetween(c,e));f.push(this.transitionsBetween(d,e));f.sort(ob.resultPointsAndTransitionsComparator);a=f[0];f=f[1];let g=new Map;nb.increment(g,a.getFrom());nb.increment(g,a.getTo());nb.increment(g,f.getFrom());nb.increment(g,f.getTo());var h=a=f=null;for(let [b,
c]of Array.from(g.entries()))2===c?a=b:null==f?f=b:h=b;if(null==f||null==a||null==h)throw new m;h=[f,a,h];z.orderBestPatterns(h);f=h[0];a=h[1];h=h[2];c=g.has(b)?g.has(c)?g.has(d)?e:d:c:b;d=this.transitionsBetween(h,c).getTransitions();e=this.transitionsBetween(f,c).getTransitions();1===(d&1)&&d++;d+=2;1===(e&1)&&e++;e+=2;4*d>=7*e||4*e>=7*d?(b=this.correctTopRightRectangular(a,f,h,c,d,e),null==b&&(b=c),d=this.transitionsBetween(h,b).getTransitions(),e=this.transitionsBetween(f,b).getTransitions(),
1===(d&1)&&d++,1===(e&1)&&e++,c=nb.sampleGrid(this.image,h,a,f,b,d,e)):(b=this.correctTopRight(a,f,h,c,Math.min(e,d)),null==b&&(b=c),c=Math.max(this.transitionsBetween(h,b).getTransitions(),this.transitionsBetween(f,b).getTransitions()),c++,1===(c&1)&&c++,c=nb.sampleGrid(this.image,h,a,f,b,c,c));return new ib(c,[h,a,f,b])}correctTopRightRectangular(a,b,c,d,e,f){let g=nb.distance(a,b)/e;var h=nb.distance(c,d);let l=(d.getX()-c.getX())/h;h=(d.getY()-c.getY())/h;let r=new z(d.getX()+g*l,d.getY()+g*h);
g=nb.distance(a,c)/f;h=nb.distance(b,d);l=(d.getX()-b.getX())/h;h=(d.getY()-b.getY())/h;a=new z(d.getX()+g*l,d.getY()+g*h);if(!this.isValid(r))return this.isValid(a)?a:null;if(!this.isValid(a))return r;d=Math.abs(e-this.transitionsBetween(c,r).getTransitions())+Math.abs(f-this.transitionsBetween(b,r).getTransitions());b=Math.abs(e-this.transitionsBetween(c,a).getTransitions())+Math.abs(f-this.transitionsBetween(b,a).getTransitions());return d<=b?r:a}correctTopRight(a,b,c,d,e){let f=nb.distance(a,
b)/e;var g=nb.distance(c,d);let h=(d.getX()-c.getX())/g;g=(d.getY()-c.getY())/g;let l=new z(d.getX()+f*h,d.getY()+f*g);f=nb.distance(a,c)/e;g=nb.distance(b,d);h=(d.getX()-b.getX())/g;g=(d.getY()-b.getY())/g;a=new z(d.getX()+f*h,d.getY()+f*g);if(!this.isValid(l))return this.isValid(a)?a:null;if(!this.isValid(a))return l;d=Math.abs(this.transitionsBetween(c,l).getTransitions()-this.transitionsBetween(b,l).getTransitions());b=Math.abs(this.transitionsBetween(c,a).getTransitions()-this.transitionsBetween(b,
a).getTransitions());return d<=b?l:a}isValid(a){return 0<=a.getX()&&a.getX()<this.image.getWidth()&&0<a.getY()&&a.getY()<this.image.getHeight()}static distance(a,b){return Ea.round(z.distance(a,b))}static increment(a,b){let c=a.get(b);a.set(b,null==c?1:c+1)}static sampleGrid(a,b,c,d,e,f,g){return mb.getInstance().sampleGrid(a,f,g,.5,.5,f-.5,.5,f-.5,g-.5,.5,g-.5,b.getX(),b.getY(),e.getX(),e.getY(),d.getX(),d.getY(),c.getX(),c.getY())}transitionsBetween(a,b){var c=a.getX()|0;let d=a.getY()|0,e=b.getX()|
0,f=b.getY()|0,g=Math.abs(f-d)>Math.abs(e-c);if(g){var h=c;c=d;d=h;h=e;e=f;f=h}h=Math.abs(e-c);let l=Math.abs(f-d),r=-h/2,u=d<f?1:-1,v=c<e?1:-1,A=0,E=this.image.get(g?d:c,g?c:d);for(let a=c,b=d;a!==e;a+=v)if(c=this.image.get(g?b:a,g?a:b),c!==E&&(A++,E=c),r+=l,0<r){if(b===f)break;b+=u;r-=h}return new ob(a,b,A)}}
class ob{constructor(a,b,c){this.from=a;this.to=b;this.transitions=c}getFrom(){return this.from}getTo(){return this.to}getTransitions(){return this.transitions}toString(){return this.from+"/"+this.to+"/"+this.transitions}static resultPointsAndTransitionsComparator(a,b){return a.getTransitions()-b.getTransitions()}}
class pb{constructor(){this.decoder=new hb}decode(a,b=null){null!=b&&b.has(x.PURE_BARCODE)?(a=pb.extractPureBits(a.getBlackMatrix()),a=this.decoder.decode(a),b=pb.NO_POINTS):(b=(new nb(a.getBlackMatrix())).detect(),a=this.decoder.decode(b.getBits()),b=b.getPoints());var c=a.getRawBytes();b=new Ha(a.getText(),c,8*c.length,b,t.DATA_MATRIX,ka.currentTimeMillis());c=a.getByteSegments();null!=c&&b.putMetadata(Da.BYTE_SEGMENTS,c);a=a.getECLevel();null!=a&&b.putMetadata(Da.ERROR_CORRECTION_LEVEL,a);return b}reset(){}static extractPureBits(a){var b=
a.getTopLeftOnBit(),c=a.getBottomRightOnBit();if(null==b||null==c)throw new m;let d=this.moduleSize(b,a),e=b[1];b=b[0];let f=(c[0]-b+1)/d;c=(c[1]-e+1)/d;if(0>=f||0>=c)throw new m;var g=d/2;e+=g;b+=g;g=new pa(f,c);for(let h=0;h<c;h++){let c=e+h*d;for(let e=0;e<f;e++)a.get(b+e*d,c)&&g.set(e,h)}return g}static moduleSize(a,b){let c=b.getWidth(),d=a[0],e=a[1];for(;d<c&&b.get(d,e);)d++;if(d===c)throw new m;a=d-a[0];if(0===a)throw new m;return a}}pb.NO_POINTS=[];var qb,rb=qb||(qb={});rb[rb.L=0]="L";
rb[rb.M=1]="M";rb[rb.Q=2]="Q";rb[rb.H=3]="H";
class R{constructor(a,b,c){this.value=a;this.stringValue=b;this.bits=c;R.FOR_BITS.set(c,this);R.FOR_VALUE.set(a,this)}getValue(){return this.value}getBits(){return this.bits}static fromString(a){switch(a){case "L":return R.L;case "M":return R.M;case "Q":return R.Q;case "H":return R.H;default:throw new ea(a+"not available");}}toString(){return this.stringValue}equals(a){return a instanceof R?this.value===a.value:!1}static forBits(a){if(0>a||a>=R.FOR_BITS.size)throw new k;return R.FOR_BITS.get(a)}}
R.FOR_BITS=new Map;R.FOR_VALUE=new Map;R.L=new R(qb.L,"L",1);R.M=new R(qb.M,"M",0);R.Q=new R(qb.Q,"Q",3);R.H=new R(qb.H,"H",2);
class sb{constructor(a){this.errorCorrectionLevel=R.forBits(a>>3&3);this.dataMask=a&7}static numBitsDiffering(a,b){return la.bitCount(a^b)}static decodeFormatInformation(a,b){let c=sb.doDecodeFormatInformation(a,b);return null!==c?c:sb.doDecodeFormatInformation(a^sb.FORMAT_INFO_MASK_QR,b^sb.FORMAT_INFO_MASK_QR)}static doDecodeFormatInformation(a,b){let c=Number.MAX_SAFE_INTEGER,d=0;for(let e of sb.FORMAT_INFO_DECODE_LOOKUP){let f=e[0];if(f===a||f===b)return new sb(e[1]);let g=sb.numBitsDiffering(a,
f);g<c&&(d=e[1],c=g);a!==b&&(g=sb.numBitsDiffering(b,f),g<c&&(d=e[1],c=g))}return 3>=c?new sb(d):null}getErrorCorrectionLevel(){return this.errorCorrectionLevel}getDataMask(){return this.dataMask}hashCode(){return this.errorCorrectionLevel.getBits()<<3|this.dataMask}equals(a){return a instanceof sb?this.errorCorrectionLevel===a.errorCorrectionLevel&&this.dataMask===a.dataMask:!1}}sb.FORMAT_INFO_MASK_QR=21522;
sb.FORMAT_INFO_DECODE_LOOKUP=[Int32Array.from([21522,0]),Int32Array.from([20773,1]),Int32Array.from([24188,2]),Int32Array.from([23371,3]),Int32Array.from([17913,4]),Int32Array.from([16590,5]),Int32Array.from([20375,6]),Int32Array.from([19104,7]),Int32Array.from([30660,8]),Int32Array.from([29427,9]),Int32Array.from([32170,10]),Int32Array.from([30877,11]),Int32Array.from([26159,12]),Int32Array.from([25368,13]),Int32Array.from([27713,14]),Int32Array.from([26998,15]),Int32Array.from([5769,16]),Int32Array.from([5054,
17]),Int32Array.from([7399,18]),Int32Array.from([6608,19]),Int32Array.from([1890,20]),Int32Array.from([597,21]),Int32Array.from([3340,22]),Int32Array.from([2107,23]),Int32Array.from([13663,24]),Int32Array.from([12392,25]),Int32Array.from([16177,26]),Int32Array.from([14854,27]),Int32Array.from([9396,28]),Int32Array.from([8579,29]),Int32Array.from([11994,30]),Int32Array.from([11245,31])];
class S{constructor(a,...b){this.ecCodewordsPerBlock=a;this.ecBlocks=b}getECCodewordsPerBlock(){return this.ecCodewordsPerBlock}getNumBlocks(){let a=0,b=this.ecBlocks;for(let c of b)a+=c.getCount();return a}getTotalECCodewords(){return this.ecCodewordsPerBlock*this.getNumBlocks()}getECBlocks(){return this.ecBlocks}}class U{constructor(a,b){this.count=a;this.dataCodewords=b}getCount(){return this.count}getDataCodewords(){return this.dataCodewords}}
class V{constructor(a,b,...c){this.versionNumber=a;this.alignmentPatternCenters=b;this.ecBlocks=c;a=0;b=c[0].getECCodewordsPerBlock();c=c[0].getECBlocks();for(let d of c)a+=d.getCount()*(d.getDataCodewords()+b);this.totalCodewords=a}getVersionNumber(){return this.versionNumber}getAlignmentPatternCenters(){return this.alignmentPatternCenters}getTotalCodewords(){return this.totalCodewords}getDimensionForVersion(){return 17+4*this.versionNumber}getECBlocksForLevel(a){return this.ecBlocks[a.getValue()]}static getProvisionalVersionForDimension(a){if(1!==
a%4)throw new p;try{return this.getVersionForNumber((a-17)/4)}catch(b){throw new p;}}static getVersionForNumber(a){if(1>a||40<a)throw new k;return V.VERSIONS[a-1]}static decodeVersionInformation(a){let b=Number.MAX_SAFE_INTEGER,c=0;for(let e=0;e<V.VERSION_DECODE_INFO.length;e++){var d=V.VERSION_DECODE_INFO[e];if(d===a)return V.getVersionForNumber(e+7);d=sb.numBitsDiffering(a,d);d<b&&(c=e+7,b=d)}return 3>=b?V.getVersionForNumber(c):null}buildFunctionPattern(){let a=this.getDimensionForVersion(),b=
new pa(a);b.setRegion(0,0,9,9);b.setRegion(a-8,0,8,9);b.setRegion(0,a-8,9,8);let c=this.alignmentPatternCenters.length;for(let a=0;a<c;a++){let d=this.alignmentPatternCenters[a]-2;for(let e=0;e<c;e++)0===a&&(0===e||e===c-1)||a===c-1&&0===e||b.setRegion(this.alignmentPatternCenters[e]-2,d,5,5)}b.setRegion(6,9,1,a-17);b.setRegion(9,6,a-17,1);6<this.versionNumber&&(b.setRegion(a-11,0,3,6),b.setRegion(0,a-11,6,3));return b}toString(){return""+this.versionNumber}}
V.VERSION_DECODE_INFO=Int32Array.from([31892,34236,39577,42195,48118,51042,55367,58893,63784,68472,70749,76311,79154,84390,87683,92361,96236,102084,102881,110507,110734,117786,119615,126325,127568,133589,136944,141498,145311,150283,152622,158308,161089,167017]);
V.VERSIONS=[new V(1,new Int32Array(0),new S(7,new U(1,19)),new S(10,new U(1,16)),new S(13,new U(1,13)),new S(17,new U(1,9))),new V(2,Int32Array.from([6,18]),new S(10,new U(1,34)),new S(16,new U(1,28)),new S(22,new U(1,22)),new S(28,new U(1,16))),new V(3,Int32Array.from([6,22]),new S(15,new U(1,55)),new S(26,new U(1,44)),new S(18,new U(2,17)),new S(22,new U(2,13))),new V(4,Int32Array.from([6,26]),new S(20,new U(1,80)),new S(18,new U(2,32)),new S(26,new U(2,24)),new S(16,new U(4,9))),new V(5,Int32Array.from([6,
30]),new S(26,new U(1,108)),new S(24,new U(2,43)),new S(18,new U(2,15),new U(2,16)),new S(22,new U(2,11),new U(2,12))),new V(6,Int32Array.from([6,34]),new S(18,new U(2,68)),new S(16,new U(4,27)),new S(24,new U(4,19)),new S(28,new U(4,15))),new V(7,Int32Array.from([6,22,38]),new S(20,new U(2,78)),new S(18,new U(4,31)),new S(18,new U(2,14),new U(4,15)),new S(26,new U(4,13),new U(1,14))),new V(8,Int32Array.from([6,24,42]),new S(24,new U(2,97)),new S(22,new U(2,38),new U(2,39)),new S(22,new U(4,18),new U(2,
19)),new S(26,new U(4,14),new U(2,15))),new V(9,Int32Array.from([6,26,46]),new S(30,new U(2,116)),new S(22,new U(3,36),new U(2,37)),new S(20,new U(4,16),new U(4,17)),new S(24,new U(4,12),new U(4,13))),new V(10,Int32Array.from([6,28,50]),new S(18,new U(2,68),new U(2,69)),new S(26,new U(4,43),new U(1,44)),new S(24,new U(6,19),new U(2,20)),new S(28,new U(6,15),new U(2,16))),new V(11,Int32Array.from([6,30,54]),new S(20,new U(4,81)),new S(30,new U(1,50),new U(4,51)),new S(28,new U(4,22),new U(4,23)),new S(24,
new U(3,12),new U(8,13))),new V(12,Int32Array.from([6,32,58]),new S(24,new U(2,92),new U(2,93)),new S(22,new U(6,36),new U(2,37)),new S(26,new U(4,20),new U(6,21)),new S(28,new U(7,14),new U(4,15))),new V(13,Int32Array.from([6,34,62]),new S(26,new U(4,107)),new S(22,new U(8,37),new U(1,38)),new S(24,new U(8,20),new U(4,21)),new S(22,new U(12,11),new U(4,12))),new V(14,Int32Array.from([6,26,46,66]),new S(30,new U(3,115),new U(1,116)),new S(24,new U(4,40),new U(5,41)),new S(20,new U(11,16),new U(5,
17)),new S(24,new U(11,12),new U(5,13))),new V(15,Int32Array.from([6,26,48,70]),new S(22,new U(5,87),new U(1,88)),new S(24,new U(5,41),new U(5,42)),new S(30,new U(5,24),new U(7,25)),new S(24,new U(11,12),new U(7,13))),new V(16,Int32Array.from([6,26,50,74]),new S(24,new U(5,98),new U(1,99)),new S(28,new U(7,45),new U(3,46)),new S(24,new U(15,19),new U(2,20)),new S(30,new U(3,15),new U(13,16))),new V(17,Int32Array.from([6,30,54,78]),new S(28,new U(1,107),new U(5,108)),new S(28,new U(10,46),new U(1,
47)),new S(28,new U(1,22),new U(15,23)),new S(28,new U(2,14),new U(17,15))),new V(18,Int32Array.from([6,30,56,82]),new S(30,new U(5,120),new U(1,121)),new S(26,new U(9,43),new U(4,44)),new S(28,new U(17,22),new U(1,23)),new S(28,new U(2,14),new U(19,15))),new V(19,Int32Array.from([6,30,58,86]),new S(28,new U(3,113),new U(4,114)),new S(26,new U(3,44),new U(11,45)),new S(26,new U(17,21),new U(4,22)),new S(26,new U(9,13),new U(16,14))),new V(20,Int32Array.from([6,34,62,90]),new S(28,new U(3,107),new U(5,
108)),new S(26,new U(3,41),new U(13,42)),new S(30,new U(15,24),new U(5,25)),new S(28,new U(15,15),new U(10,16))),new V(21,Int32Array.from([6,28,50,72,94]),new S(28,new U(4,116),new U(4,117)),new S(26,new U(17,42)),new S(28,new U(17,22),new U(6,23)),new S(30,new U(19,16),new U(6,17))),new V(22,Int32Array.from([6,26,50,74,98]),new S(28,new U(2,111),new U(7,112)),new S(28,new U(17,46)),new S(30,new U(7,24),new U(16,25)),new S(24,new U(34,13))),new V(23,Int32Array.from([6,30,54,78,102]),new S(30,new U(4,
121),new U(5,122)),new S(28,new U(4,47),new U(14,48)),new S(30,new U(11,24),new U(14,25)),new S(30,new U(16,15),new U(14,16))),new V(24,Int32Array.from([6,28,54,80,106]),new S(30,new U(6,117),new U(4,118)),new S(28,new U(6,45),new U(14,46)),new S(30,new U(11,24),new U(16,25)),new S(30,new U(30,16),new U(2,17))),new V(25,Int32Array.from([6,32,58,84,110]),new S(26,new U(8,106),new U(4,107)),new S(28,new U(8,47),new U(13,48)),new S(30,new U(7,24),new U(22,25)),new S(30,new U(22,15),new U(13,16))),new V(26,
Int32Array.from([6,30,58,86,114]),new S(28,new U(10,114),new U(2,115)),new S(28,new U(19,46),new U(4,47)),new S(28,new U(28,22),new U(6,23)),new S(30,new U(33,16),new U(4,17))),new V(27,Int32Array.from([6,34,62,90,118]),new S(30,new U(8,122),new U(4,123)),new S(28,new U(22,45),new U(3,46)),new S(30,new U(8,23),new U(26,24)),new S(30,new U(12,15),new U(28,16))),new V(28,Int32Array.from([6,26,50,74,98,122]),new S(30,new U(3,117),new U(10,118)),new S(28,new U(3,45),new U(23,46)),new S(30,new U(4,24),
new U(31,25)),new S(30,new U(11,15),new U(31,16))),new V(29,Int32Array.from([6,30,54,78,102,126]),new S(30,new U(7,116),new U(7,117)),new S(28,new U(21,45),new U(7,46)),new S(30,new U(1,23),new U(37,24)),new S(30,new U(19,15),new U(26,16))),new V(30,Int32Array.from([6,26,52,78,104,130]),new S(30,new U(5,115),new U(10,116)),new S(28,new U(19,47),new U(10,48)),new S(30,new U(15,24),new U(25,25)),new S(30,new U(23,15),new U(25,16))),new V(31,Int32Array.from([6,30,56,82,108,134]),new S(30,new U(13,115),
new U(3,116)),new S(28,new U(2,46),new U(29,47)),new S(30,new U(42,24),new U(1,25)),new S(30,new U(23,15),new U(28,16))),new V(32,Int32Array.from([6,34,60,86,112,138]),new S(30,new U(17,115)),new S(28,new U(10,46),new U(23,47)),new S(30,new U(10,24),new U(35,25)),new S(30,new U(19,15),new U(35,16))),new V(33,Int32Array.from([6,30,58,86,114,142]),new S(30,new U(17,115),new U(1,116)),new S(28,new U(14,46),new U(21,47)),new S(30,new U(29,24),new U(19,25)),new S(30,new U(11,15),new U(46,16))),new V(34,
Int32Array.from([6,34,62,90,118,146]),new S(30,new U(13,115),new U(6,116)),new S(28,new U(14,46),new U(23,47)),new S(30,new U(44,24),new U(7,25)),new S(30,new U(59,16),new U(1,17))),new V(35,Int32Array.from([6,30,54,78,102,126,150]),new S(30,new U(12,121),new U(7,122)),new S(28,new U(12,47),new U(26,48)),new S(30,new U(39,24),new U(14,25)),new S(30,new U(22,15),new U(41,16))),new V(36,Int32Array.from([6,24,50,76,102,128,154]),new S(30,new U(6,121),new U(14,122)),new S(28,new U(6,47),new U(34,48)),
new S(30,new U(46,24),new U(10,25)),new S(30,new U(2,15),new U(64,16))),new V(37,Int32Array.from([6,28,54,80,106,132,158]),new S(30,new U(17,122),new U(4,123)),new S(28,new U(29,46),new U(14,47)),new S(30,new U(49,24),new U(10,25)),new S(30,new U(24,15),new U(46,16))),new V(38,Int32Array.from([6,32,58,84,110,136,162]),new S(30,new U(4,122),new U(18,123)),new S(28,new U(13,46),new U(32,47)),new S(30,new U(48,24),new U(14,25)),new S(30,new U(42,15),new U(32,16))),new V(39,Int32Array.from([6,26,54,82,
110,138,166]),new S(30,new U(20,117),new U(4,118)),new S(28,new U(40,47),new U(7,48)),new S(30,new U(43,24),new U(22,25)),new S(30,new U(10,15),new U(67,16))),new V(40,Int32Array.from([6,30,58,86,114,142,170]),new S(30,new U(19,118),new U(6,119)),new S(28,new U(18,47),new U(31,48)),new S(30,new U(34,24),new U(34,25)),new S(30,new U(20,15),new U(61,16)))];var tb,ub=tb||(tb={});ub[ub.DATA_MASK_000=0]="DATA_MASK_000";ub[ub.DATA_MASK_001=1]="DATA_MASK_001";ub[ub.DATA_MASK_010=2]="DATA_MASK_010";
ub[ub.DATA_MASK_011=3]="DATA_MASK_011";ub[ub.DATA_MASK_100=4]="DATA_MASK_100";ub[ub.DATA_MASK_101=5]="DATA_MASK_101";ub[ub.DATA_MASK_110=6]="DATA_MASK_110";ub[ub.DATA_MASK_111=7]="DATA_MASK_111";class vb{constructor(a,b){this.value=a;this.isMasked=b}unmaskBitMatrix(a,b){for(let c=0;c<b;c++)for(let d=0;d<b;d++)this.isMasked(c,d)&&a.flip(d,c)}}
vb.values=new Map([[tb.DATA_MASK_000,new vb(tb.DATA_MASK_000,(a,b)=>0===(a+b&1))],[tb.DATA_MASK_001,new vb(tb.DATA_MASK_001,(a)=>0===(a&1))],[tb.DATA_MASK_010,new vb(tb.DATA_MASK_010,(a,b)=>0===b%3)],[tb.DATA_MASK_011,new vb(tb.DATA_MASK_011,(a,b)=>0===(a+b)%3)],[tb.DATA_MASK_100,new vb(tb.DATA_MASK_100,(a,b)=>0===(Math.floor(a/2)+Math.floor(b/3)&1))],[tb.DATA_MASK_101,new vb(tb.DATA_MASK_101,(a,b)=>0===a*b%6)],[tb.DATA_MASK_110,new vb(tb.DATA_MASK_110,(a,b)=>3>a*b%6)],[tb.DATA_MASK_111,new vb(tb.DATA_MASK_111,
(a,b)=>0===(a+b+a*b%3&1))]]);
class wb{constructor(a){let b=a.getHeight();if(21>b||1!==(b&3))throw new p;this.bitMatrix=a}readFormatInformation(){if(null!==this.parsedFormatInfo&&void 0!==this.parsedFormatInfo)return this.parsedFormatInfo;let a=0;for(var b=0;6>b;b++)a=this.copyBit(b,8,a);a=this.copyBit(7,8,a);a=this.copyBit(8,8,a);a=this.copyBit(8,7,a);for(b=5;0<=b;b--)a=this.copyBit(8,b,a);b=this.bitMatrix.getHeight();let c=0;var d=b-7;for(let a=b-1;a>=d;a--)c=this.copyBit(8,a,c);for(d=b-8;d<b;d++)c=this.copyBit(d,8,c);this.parsedFormatInfo=
sb.decodeFormatInformation(a,c);if(null!==this.parsedFormatInfo)return this.parsedFormatInfo;throw new p;}readVersion(){if(null!==this.parsedVersion&&void 0!==this.parsedVersion)return this.parsedVersion;let a=this.bitMatrix.getHeight();var b=Math.floor((a-17)/4);if(6>=b)return V.getVersionForNumber(b);var c=0;b=a-11;for(var d=5;0<=d;d--)for(var e=a-9;e>=b;e--)c=this.copyBit(e,d,c);c=V.decodeVersionInformation(c);if(null!==c&&c.getDimensionForVersion()===a)return this.parsedVersion=c;c=0;for(d=5;0<=
d;d--)for(e=a-9;e>=b;e--)c=this.copyBit(d,e,c);c=V.decodeVersionInformation(c);if(null!==c&&c.getDimensionForVersion()===a)return this.parsedVersion=c;throw new p;}copyBit(a,b,c){return(this.isMirror?this.bitMatrix.get(b,a):this.bitMatrix.get(a,b))?c<<1|1:c<<1}readCodewords(){var a=this.readFormatInformation();let b=this.readVersion();var c=vb.values.get(a.getDataMask());a=this.bitMatrix.getHeight();c.unmaskBitMatrix(this.bitMatrix,a);c=b.buildFunctionPattern();let d=!0,e=new Uint8Array(b.getTotalCodewords()),
f=0,g=0,h=0;for(let b=a-1;0<b;b-=2){6===b&&b--;for(let l=0;l<a;l++){let r=d?a-1-l:l;for(let a=0;2>a;a++)c.get(b-a,r)||(h++,g<<=1,this.bitMatrix.get(b-a,r)&&(g|=1),8===h&&(e[f++]=g,g=h=0))}d=!d}if(f!==b.getTotalCodewords())throw new p;return e}remask(){if(null!==this.parsedFormatInfo){var a=vb.values[this.parsedFormatInfo.getDataMask()],b=this.bitMatrix.getHeight();a.unmaskBitMatrix(this.bitMatrix,b)}}setMirror(a){this.parsedFormatInfo=this.parsedVersion=null;this.isMirror=a}mirror(){let a=this.bitMatrix;
for(let b=0,c=a.getWidth();b<c;b++)for(let c=b+1,e=a.getHeight();c<e;c++)a.get(b,c)!==a.get(c,b)&&(a.flip(c,b),a.flip(b,c))}}class xb{constructor(a){this.mirrored=a}isMirrored(){return this.mirrored}applyMirroredCorrection(a){if(this.mirrored&&null!==a&&!(3>a.length)){var b=a[0];a[0]=a[2];a[2]=b}}}
class yb{constructor(a,b){this.numDataCodewords=a;this.codewords=b}static getDataBlocks(a,b,c){if(a.length!==b.getTotalCodewords())throw new k;c=b.getECBlocksForLevel(c);b=0;var d=c.getECBlocks();for(var e of d)b+=e.getCount();e=Array(b);b=0;for(var f of d)for(d=0;d<f.getCount();d++){var g=f.getDataCodewords(),h=c.getECCodewordsPerBlock()+g;e[b++]=new yb(g,new Uint8Array(h))}d=e[0].codewords.length;for(f=e.length-1;0<=f&&e[f].codewords.length!==d;)f--;f++;d-=c.getECCodewordsPerBlock();c=0;for(g=0;g<
d;g++)for(h=0;h<b;h++)e[h].codewords[g]=a[c++];for(g=f;g<b;g++)e[g].codewords[d]=a[c++];for(g=e[0].codewords.length;d<g;d++)for(h=0;h<b;h++)e[h].codewords[h<f?d:d+1]=a[c++];return e}getNumDataCodewords(){return this.numDataCodewords}getCodewords(){return this.codewords}}
class P{StringUtils(){}static guessEncoding(a,b){if(null!==b&&void 0!==b&&void 0!==b.get(x.CHARACTER_SET))return b.get(x.CHARACTER_SET).toString();b=a.length;let c=!0,d=!0,e=!0,f=0,g=0,h=0,l=0,r=0,u=0,v=0,A=0,E=0,T=0,B=0,Fa=3<a.length&&239===a[0]&&187===a[1]&&191===a[2];for(let ya=0;ya<b&&(c||d||e);ya++){let b=a[ya]&255;e&&(0<f?0===(b&128)?e=!1:f--:0!==(b&128)&&(0===(b&64)?e=!1:(f++,0===(b&32)?g++:(f++,0===(b&16)?h++:(f++,0===(b&8)?l++:e=!1)))));c&&(127<b&&160>b?c=!1:159<b&&(192>b||215===b||247===
b)&&B++);d&&(0<r?64>b||127===b||252<b?d=!1:r--:128===b||160===b||239<b?d=!1:160<b&&224>b?(u++,A=0,v++,v>E&&(E=v)):127<b?(r++,v=0,A++,A>T&&(T=A)):A=v=0)}e&&0<f&&(e=!1);d&&0<r&&(d=!1);return e&&(Fa||0<g+h+l)?P.UTF8:d&&(P.ASSUME_SHIFT_JIS||3<=E||3<=T)?P.SHIFT_JIS:c&&d?2===E&&2===u||10*B>=b?P.SHIFT_JIS:P.ISO88591:c?P.ISO88591:d?P.SHIFT_JIS:P.UTF8}}P.SHIFT_JIS=O.SJIS.getName();P.GB2312="GB2312";P.ISO88591=O.ISO8859_1.getName();P.EUC_JP="EUC_JP";P.UTF8=O.UTF8.getName();P.PLATFORM_DEFAULT_ENCODING=null;
P.ASSUME_SHIFT_JIS=!1;var zb,W=zb||(zb={});W[W.TERMINATOR=0]="TERMINATOR";W[W.NUMERIC=1]="NUMERIC";W[W.ALPHANUMERIC=2]="ALPHANUMERIC";W[W.STRUCTURED_APPEND=3]="STRUCTURED_APPEND";W[W.BYTE=4]="BYTE";W[W.ECI=5]="ECI";W[W.KANJI=6]="KANJI";W[W.FNC1_FIRST_POSITION=7]="FNC1_FIRST_POSITION";W[W.FNC1_SECOND_POSITION=8]="FNC1_SECOND_POSITION";W[W.HANZI=9]="HANZI";
class X{constructor(a,b,c,d){this.value=a;this.stringValue=b;this.characterCountBitsForVersions=c;this.bits=d;X.FOR_BITS.set(d,this);X.FOR_VALUE.set(a,this)}static forBits(a){a=X.FOR_BITS.get(a);if(void 0===a)throw new k;return a}getCharacterCountBits(a){a=a.getVersionNumber();return this.characterCountBitsForVersions[9>=a?0:26>=a?1:2]}getValue(){return this.value}getBits(){return this.bits}equals(a){return a instanceof X?this.value===a.value:!1}toString(){return this.stringValue}}X.FOR_BITS=new Map;
X.FOR_VALUE=new Map;X.TERMINATOR=new X(zb.TERMINATOR,"TERMINATOR",Int32Array.from([0,0,0]),0);X.NUMERIC=new X(zb.NUMERIC,"NUMERIC",Int32Array.from([10,12,14]),1);X.ALPHANUMERIC=new X(zb.ALPHANUMERIC,"ALPHANUMERIC",Int32Array.from([9,11,13]),2);X.STRUCTURED_APPEND=new X(zb.STRUCTURED_APPEND,"STRUCTURED_APPEND",Int32Array.from([0,0,0]),3);X.BYTE=new X(zb.BYTE,"BYTE",Int32Array.from([8,16,16]),4);X.ECI=new X(zb.ECI,"ECI",Int32Array.from([0,0,0]),7);
X.KANJI=new X(zb.KANJI,"KANJI",Int32Array.from([8,10,12]),8);X.FNC1_FIRST_POSITION=new X(zb.FNC1_FIRST_POSITION,"FNC1_FIRST_POSITION",Int32Array.from([0,0,0]),5);X.FNC1_SECOND_POSITION=new X(zb.FNC1_SECOND_POSITION,"FNC1_SECOND_POSITION",Int32Array.from([0,0,0]),9);X.HANZI=new X(zb.HANZI,"HANZI",Int32Array.from([8,10,12]),13);
class Y{static decode(a,b,c,d){let e=new cb(a),f=new oa,g=[],h=-1,l=-1;try{let a=null,c=!1,v;do{if(4>e.available())v=X.TERMINATOR;else{let a=e.readBits(4);v=X.forBits(a)}switch(v){case X.TERMINATOR:break;case X.FNC1_FIRST_POSITION:case X.FNC1_SECOND_POSITION:c=!0;break;case X.STRUCTURED_APPEND:if(16>e.available())throw new p;h=e.readBits(8);l=e.readBits(8);break;case X.ECI:let r=Y.parseECIValue(e);a=O.getCharacterSetECIByValue(r);if(null===a)throw new p;break;case X.HANZI:let u=e.readBits(4),T=e.readBits(v.getCharacterCountBits(b));
u===Y.GB2312_SUBSET&&Y.decodeHanziSegment(e,f,T);break;default:let B=e.readBits(v.getCharacterCountBits(b));switch(v){case X.NUMERIC:Y.decodeNumericSegment(e,f,B);break;case X.ALPHANUMERIC:Y.decodeAlphanumericSegment(e,f,B,c);break;case X.BYTE:Y.decodeByteSegment(e,f,B,a,g,d);break;case X.KANJI:Y.decodeKanjiSegment(e,f,B);break;default:throw new p;}}}while(v!==X.TERMINATOR)}catch(r){throw new p;}return new bb(a,f.toString(),0===g.length?null:g,null===c?null:c.toString(),h,l)}static decodeHanziSegment(a,
b,c){if(13*c>a.available())throw new p;let d=new Uint8Array(2*c),e=0;for(;0<c;){var f=a.readBits(13);f=f/96<<8&4294967295|f%96;f=959>f?f+41377:f+42657;d[e]=f>>8&255;d[e+1]=f&255;e+=2;c--}try{b.append(db.decode(d,P.GB2312))}catch(g){throw new p(g);}}static decodeKanjiSegment(a,b,c){if(13*c>a.available())throw new p;let d=new Uint8Array(2*c),e=0;for(;0<c;){var f=a.readBits(13);f=f/192<<8&4294967295|f%192;f=7936>f?f+33088:f+49472;d[e]=f>>8;d[e+1]=f;e+=2;c--}try{b.append(db.decode(d,P.SHIFT_JIS))}catch(g){throw new p(g);
}}static decodeByteSegment(a,b,c,d,e,f){if(8*c>a.available())throw new p;let g=new Uint8Array(c);for(let b=0;b<c;b++)g[b]=a.readBits(8);a=null===d?P.guessEncoding(g,f):d.getName();try{b.append(db.decode(g,a))}catch(h){throw new p(h);}e.push(g)}static toAlphaNumericChar(a){if(a>=Y.ALPHANUMERIC_CHARS.length)throw new p;return Y.ALPHANUMERIC_CHARS[a]}static decodeAlphanumericSegment(a,b,c,d){let e=b.length();for(;1<c;){if(11>a.available())throw new p;let d=a.readBits(11);b.append(Y.toAlphaNumericChar(Math.floor(d/
45)));b.append(Y.toAlphaNumericChar(d%45));c-=2}if(1===c){if(6>a.available())throw new p;b.append(Y.toAlphaNumericChar(a.readBits(6)))}if(d)for(a=e;a<b.length();a++)"%"===b.charAt(a)&&(a<b.length()-1&&"%"===b.charAt(a+1)?b.deleteCharAt(a+1):b.setCharAt(a,String.fromCharCode(29)))}static decodeNumericSegment(a,b,c){for(;3<=c;){if(10>a.available())throw new p;let d=a.readBits(10);if(1E3<=d)throw new p;b.append(Y.toAlphaNumericChar(Math.floor(d/100)));b.append(Y.toAlphaNumericChar(Math.floor(d/10)%10));
b.append(Y.toAlphaNumericChar(d%10));c-=3}if(2===c){if(7>a.available())throw new p;a=a.readBits(7);if(100<=a)throw new p;b.append(Y.toAlphaNumericChar(Math.floor(a/10)));b.append(Y.toAlphaNumericChar(a%10))}else if(1===c){if(4>a.available())throw new p;a=a.readBits(4);if(10<=a)throw new p;b.append(Y.toAlphaNumericChar(a))}}static parseECIValue(a){let b=a.readBits(8);if(0===(b&128))return b&127;if(128===(b&192))return a=a.readBits(8),(b&63)<<8&4294967295|a;if(192===(b&224))return a=a.readBits(16),
(b&31)<<16&4294967295|a;throw new p;}}Y.ALPHANUMERIC_CHARS="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ $%*+-./:";Y.GB2312_SUBSET=1;
class Ab{constructor(){this.rsDecoder=new Za(I.QR_CODE_FIELD_256)}decodeBooleanArray(a,b){return this.decodeBitMatrix(pa.parseFromBooleanArray(a),b)}decodeBitMatrix(a,b){a=new wb(a);let c;try{return this.decodeBitMatrixParser(a,b)}catch(d){c=d}try{a.remask();a.setMirror(!0);a.readVersion();a.readFormatInformation();a.mirror();let c=this.decodeBitMatrixParser(a,b);c.setOther(new xb(!0));return c}catch(d){if(null!==c)throw c;throw d;}}decodeBitMatrixParser(a,b){let c=a.readVersion(),d=a.readFormatInformation().getErrorCorrectionLevel();
a=a.readCodewords();var e=yb.getDataBlocks(a,c,d);a=0;for(var f of e)a+=f.getNumDataCodewords();f=new Uint8Array(a);a=0;for(let b of e){e=b.getCodewords();let c=b.getNumDataCodewords();this.correctErrors(e,c);for(let b=0;b<c;b++)f[a++]=e[b]}return Y.decode(f,c,d,b)}correctErrors(a,b){let c=new Int32Array(a);try{this.rsDecoder.decode(c,a.length-b)}catch(d){throw new ia;}for(let d=0;d<b;d++)a[d]=c[d]}}
class Bb extends z{constructor(a,b,c,d){super(a,b);this.estimatedModuleSize=c;this.count=d;void 0===d&&(this.count=1)}getEstimatedModuleSize(){return this.estimatedModuleSize}getCount(){return this.count}aboutEquals(a,b,c){return Math.abs(b-this.getY())<=a&&Math.abs(c-this.getX())<=a?(a=Math.abs(a-this.estimatedModuleSize),1>=a||a<=this.estimatedModuleSize):!1}combineEstimate(a,b,c){let d=this.count+1;b=(this.count*this.getX()+b)/d;a=(this.count*this.getY()+a)/d;return new Bb(b,a,(this.count*this.estimatedModuleSize+
c)/d,d)}}class Cb{constructor(a){this.bottomLeft=a[0];this.topLeft=a[1];this.topRight=a[2]}getBottomLeft(){return this.bottomLeft}getTopLeft(){return this.topLeft}getTopRight(){return this.topRight}}
class Db{constructor(a,b){this.image=a;this.resultPointCallback=b;this.possibleCenters=[];this.crossCheckStateCount=new Int32Array(5);this.resultPointCallback=b}getImage(){return this.image}getPossibleCenters(){return this.possibleCenters}find(a){var b=null!==a&&void 0!==a&&void 0!==a.get(x.TRY_HARDER);a=null!==a&&void 0!==a&&void 0!==a.get(x.PURE_BARCODE);let c=this.image,d=c.getHeight(),e=c.getWidth(),f=Math.floor(3*d/(4*Db.MAX_MODULES));if(f<Db.MIN_SKIP||b)f=Db.MIN_SKIP;b=!1;let g=new Int32Array(5);
for(let l=f-1;l<d&&!b;l+=f){g[0]=0;g[1]=0;g[2]=0;g[3]=0;var h=g[4]=0;for(let d=0;d<e;d++)c.get(d,l)?(1===(h&1)&&h++,g[h]++):0===(h&1)?4===h?Db.foundPatternCross(g)?!0===this.handlePossibleCenter(g,l,d,a)?(f=2,!0===this.hasSkipped?b=this.haveMultiplyConfirmedCenters():(h=this.findRowSkip(),h>g[2]&&(l+=h-g[2]-f,d=e-1)),h=0,g[0]=0,g[1]=0,g[2]=0,g[3]=0,g[4]=0):(g[0]=g[2],g[1]=g[3],g[2]=g[4],g[3]=1,g[4]=0,h=3):(g[0]=g[2],g[1]=g[3],g[2]=g[4],g[3]=1,g[4]=0,h=3):g[++h]++:g[h]++;Db.foundPatternCross(g)&&!0===
this.handlePossibleCenter(g,l,e,a)&&(f=g[0],this.hasSkipped&&(b=this.haveMultiplyConfirmedCenters()))}a=this.selectBestPatterns();z.orderBestPatterns(a);return new Cb(a)}static centerFromEnd(a,b){return b-a[4]-a[3]-a[2]/2}static foundPatternCross(a){var b=0;for(var c=0;5>c;c++){let d=a[c];if(0===d)return!1;b+=d}if(7>b)return!1;b/=7;c=b/2;return Math.abs(b-a[0])<c&&Math.abs(b-a[1])<c&&Math.abs(3*b-a[2])<3*c&&Math.abs(b-a[3])<c&&Math.abs(b-a[4])<c}getCrossCheckStateCount(){let a=this.crossCheckStateCount;
a[0]=0;a[1]=0;a[2]=0;a[3]=0;a[4]=0;return a}crossCheckDiagonal(a,b,c,d){let e=this.getCrossCheckStateCount(),f=0,g=this.image;for(;a>=f&&b>=f&&g.get(b-f,a-f);)e[2]++,f++;if(a<f||b<f)return!1;for(;a>=f&&b>=f&&!g.get(b-f,a-f)&&e[1]<=c;)e[1]++,f++;if(a<f||b<f||e[1]>c)return!1;for(;a>=f&&b>=f&&g.get(b-f,a-f)&&e[0]<=c;)e[0]++,f++;if(e[0]>c)return!1;let h=g.getHeight(),l=g.getWidth();for(f=1;a+f<h&&b+f<l&&g.get(b+f,a+f);)e[2]++,f++;if(a+f>=h||b+f>=l)return!1;for(;a+f<h&&b+f<l&&!g.get(b+f,a+f)&&e[3]<c;)e[3]++,
f++;if(a+f>=h||b+f>=l||e[3]>=c)return!1;for(;a+f<h&&b+f<l&&g.get(b+f,a+f)&&e[4]<c;)e[4]++,f++;return e[4]>=c?!1:Math.abs(e[0]+e[1]+e[2]+e[3]+e[4]-d)<2*d&&Db.foundPatternCross(e)}crossCheckVertical(a,b,c,d){let e=this.image,f=e.getHeight(),g=this.getCrossCheckStateCount(),h=a;for(;0<=h&&e.get(b,h);)g[2]++,h--;if(0>h)return NaN;for(;0<=h&&!e.get(b,h)&&g[1]<=c;)g[1]++,h--;if(0>h||g[1]>c)return NaN;for(;0<=h&&e.get(b,h)&&g[0]<=c;)g[0]++,h--;if(g[0]>c)return NaN;for(h=a+1;h<f&&e.get(b,h);)g[2]++,h++;if(h===
f)return NaN;for(;h<f&&!e.get(b,h)&&g[3]<c;)g[3]++,h++;if(h===f||g[3]>=c)return NaN;for(;h<f&&e.get(b,h)&&g[4]<c;)g[4]++,h++;return g[4]>=c||5*Math.abs(g[0]+g[1]+g[2]+g[3]+g[4]-d)>=2*d?NaN:Db.foundPatternCross(g)?Db.centerFromEnd(g,h):NaN}crossCheckHorizontal(a,b,c,d){let e=this.image,f=e.getWidth(),g=this.getCrossCheckStateCount(),h=a;for(;0<=h&&e.get(h,b);)g[2]++,h--;if(0>h)return NaN;for(;0<=h&&!e.get(h,b)&&g[1]<=c;)g[1]++,h--;if(0>h||g[1]>c)return NaN;for(;0<=h&&e.get(h,b)&&g[0]<=c;)g[0]++,h--;
if(g[0]>c)return NaN;for(h=a+1;h<f&&e.get(h,b);)g[2]++,h++;if(h===f)return NaN;for(;h<f&&!e.get(h,b)&&g[3]<c;)g[3]++,h++;if(h===f||g[3]>=c)return NaN;for(;h<f&&e.get(h,b)&&g[4]<c;)g[4]++,h++;return g[4]>=c||5*Math.abs(g[0]+g[1]+g[2]+g[3]+g[4]-d)>=d?NaN:Db.foundPatternCross(g)?Db.centerFromEnd(g,h):NaN}handlePossibleCenter(a,b,c,d){var e=a[0]+a[1]+a[2]+a[3]+a[4];c=Db.centerFromEnd(a,c);b=this.crossCheckVertical(b,Math.floor(c),a[2],e);if(!(isNaN(b)||(c=this.crossCheckHorizontal(Math.floor(c),Math.floor(b),
a[2],e),isNaN(c)||d&&!this.crossCheckDiagonal(Math.floor(b),Math.floor(c),a[2],e)))){d=e/7;e=!1;a=this.possibleCenters;for(let f=0,g=a.length;f<g;f++){let g=a[f];if(g.aboutEquals(d,b,c)){a[f]=g.combineEstimate(b,c,d);e=!0;break}}e||(c=new Bb(c,b,d),a.push(c),null!==this.resultPointCallback&&void 0!==this.resultPointCallback&&this.resultPointCallback.foundPossibleResultPoint(c));return!0}return!1}findRowSkip(){if(1>=this.possibleCenters.length)return 0;let a=null;for(let b of this.possibleCenters)if(b.getCount()>=
Db.CENTER_QUORUM)if(null==a)a=b;else return this.hasSkipped=!0,Math.floor((Math.abs(a.getX()-b.getX())-Math.abs(a.getY()-b.getY()))/2);return 0}haveMultiplyConfirmedCenters(){var a=0;let b=0;var c=this.possibleCenters.length;for(let c of this.possibleCenters)c.getCount()>=Db.CENTER_QUORUM&&(a++,b+=c.getEstimatedModuleSize());if(3>a)return!1;a=b/c;c=0;for(let b of this.possibleCenters)c+=Math.abs(b.getEstimatedModuleSize()-a);return c<=.05*b}selectBestPatterns(){var a=this.possibleCenters.length;if(3>
a)throw new m;let b=this.possibleCenters,c;if(3<a){var d=0;let e=0;for(let a of this.possibleCenters){let b=a.getEstimatedModuleSize();d+=b;e+=b*b}c=d/a;a=Math.sqrt(e/a-c*c);b.sort((a,b)=>{b=Math.abs(b.getEstimatedModuleSize()-c);a=Math.abs(a.getEstimatedModuleSize()-c);return b<a?-1:b>a?1:0});a=Math.max(.2*c,a);for(d=0;d<b.length&&3<b.length;d++)Math.abs(b[d].getEstimatedModuleSize()-c)>a&&(b.splice(d,1),d--)}if(3<b.length){a=0;for(let c of b)a+=c.getEstimatedModuleSize();c=a/b.length;b.sort((a,
b)=>b.getCount()===a.getCount()?(b=Math.abs(b.getEstimatedModuleSize()-c),a=Math.abs(a.getEstimatedModuleSize()-c),b<a?1:b>a?-1:0):b.getCount()-a.getCount());b.splice(3)}return[b[0],b[1],b[2]]}}Db.CENTER_QUORUM=2;Db.MIN_SKIP=3;Db.MAX_MODULES=57;
class Eb extends z{constructor(a,b,c){super(a,b);this.estimatedModuleSize=c}aboutEquals(a,b,c){return Math.abs(b-this.getY())<=a&&Math.abs(c-this.getX())<=a?(a=Math.abs(a-this.estimatedModuleSize),1>=a||a<=this.estimatedModuleSize):!1}combineEstimate(a,b,c){b=(this.getX()+b)/2;a=(this.getY()+a)/2;return new Eb(b,a,(this.estimatedModuleSize+c)/2)}}
class Fb{constructor(a,b,c,d,e,f,g){this.image=a;this.startX=b;this.startY=c;this.width=d;this.height=e;this.moduleSize=f;this.resultPointCallback=g;this.possibleCenters=[];this.crossCheckStateCount=new Int32Array(3)}find(){let a=this.startX,b=this.height,c=a+this.width,d=this.startY+b/2,e=new Int32Array(3),f=this.image;for(let l=0;l<b;l++){var g=d+(0===(l&1)?Math.floor((l+1)/2):-Math.floor((l+1)/2));e[0]=0;e[1]=0;e[2]=0;let b=a;for(;b<c&&!f.get(b,g);)b++;for(var h=0;b<c;){if(f.get(b,g))if(1===h)e[1]++;
else if(2===h){if(this.foundPatternCross(e)&&(h=this.handlePossibleCenter(e,g,b),null!==h))return h;e[0]=e[2];e[1]=1;e[2]=0;h=1}else e[++h]++;else 1===h&&h++,e[h]++;b++}if(this.foundPatternCross(e)&&(g=this.handlePossibleCenter(e,g,c),null!==g))return g}if(0!==this.possibleCenters.length)return this.possibleCenters[0];throw new m;}static centerFromEnd(a,b){return b-a[2]-a[1]/2}foundPatternCross(a){let b=this.moduleSize,c=b/2;for(let d=0;3>d;d++)if(Math.abs(b-a[d])>=c)return!1;return!0}crossCheckVertical(a,
b,c,d){let e=this.image,f=e.getHeight(),g=this.crossCheckStateCount;g[0]=0;g[1]=0;g[2]=0;let h=a;for(;0<=h&&e.get(b,h)&&g[1]<=c;)g[1]++,h--;if(0>h||g[1]>c)return NaN;for(;0<=h&&!e.get(b,h)&&g[0]<=c;)g[0]++,h--;if(g[0]>c)return NaN;for(h=a+1;h<f&&e.get(b,h)&&g[1]<=c;)g[1]++,h++;if(h===f||g[1]>c)return NaN;for(;h<f&&!e.get(b,h)&&g[2]<=c;)g[2]++,h++;return g[2]>c||5*Math.abs(g[0]+g[1]+g[2]-d)>=2*d?NaN:this.foundPatternCross(g)?Fb.centerFromEnd(g,h):NaN}handlePossibleCenter(a,b,c){let d=a[0]+a[1]+a[2];
c=Fb.centerFromEnd(a,c);b=this.crossCheckVertical(b,c,2*a[1],d);if(!isNaN(b)){a=(a[0]+a[1]+a[2])/3;for(var e of this.possibleCenters)if(e.aboutEquals(a,b,c))return e.combineEstimate(b,c,a);e=new Eb(c,b,a);this.possibleCenters.push(e);null!==this.resultPointCallback&&void 0!==this.resultPointCallback&&this.resultPointCallback.foundPossibleResultPoint(e)}return null}}
class Gb{constructor(a){this.image=a}getImage(){return this.image}getResultPointCallback(){return this.resultPointCallback}detect(a){this.resultPointCallback=null===a||void 0===a?null:a.get(x.NEED_RESULT_POINT_CALLBACK);a=(new Db(this.image,this.resultPointCallback)).find(a);return this.processFinderPatternInfo(a)}processFinderPatternInfo(a){let b=a.getTopLeft(),c=a.getTopRight();a=a.getBottomLeft();var d=this.calculateModuleSize(b,c,a);if(1>d)throw new m("No pattern found in proccess finder.");var e=
Gb.computeDimension(b,c,a,d),f=V.getProvisionalVersionForDimension(e),g=f.getDimensionForVersion()-7;let h=null;if(0<f.getAlignmentPatternCenters().length){var l=c.getX()-b.getX()+a.getX();f=c.getY()-b.getY()+a.getY();let e=1-3/g;g=Math.floor(b.getX()+e*(l-b.getX()));f=Math.floor(b.getY()+e*(f-b.getY()));for(l=4;16>=l;l<<=1)try{h=this.findAlignmentInRegion(d,g,f,l);break}catch(u){if(!(u instanceof m))throw u;}}d=Gb.createTransform(b,c,a,h,e);e=Gb.sampleGrid(this.image,d,e);return new ib(e,null===
h?[a,b,c]:[a,b,c,h])}static createTransform(a,b,c,d,e){e-=3.5;let f,g,h;null!==d?(f=d.getX(),d=d.getY(),h=g=e-3):(f=b.getX()-a.getX()+c.getX(),d=b.getY()-a.getY()+c.getY(),h=g=e);return kb.quadrilateralToQuadrilateral(3.5,3.5,e,3.5,g,h,3.5,e,a.getX(),a.getY(),b.getX(),b.getY(),f,d,c.getX(),c.getY())}static sampleGrid(a,b,c){return mb.getInstance().sampleGridWithTransform(a,c,c,b)}static computeDimension(a,b,c,d){b=Ea.round(z.distance(a,b)/d);a=Ea.round(z.distance(a,c)/d);a=Math.floor((b+a)/2)+7;switch(a&
3){case 0:a++;break;case 2:a--;break;case 3:throw new m("Dimensions could be not found.");}return a}calculateModuleSize(a,b,c){return(this.calculateModuleSizeOneWay(a,b)+this.calculateModuleSizeOneWay(a,c))/2}calculateModuleSizeOneWay(a,b){let c=this.sizeOfBlackWhiteBlackRunBothWays(Math.floor(a.getX()),Math.floor(a.getY()),Math.floor(b.getX()),Math.floor(b.getY()));a=this.sizeOfBlackWhiteBlackRunBothWays(Math.floor(b.getX()),Math.floor(b.getY()),Math.floor(a.getX()),Math.floor(a.getY()));return isNaN(c)?
a/7:isNaN(a)?c/7:(c+a)/14}sizeOfBlackWhiteBlackRunBothWays(a,b,c,d){let e=this.sizeOfBlackWhiteBlackRun(a,b,c,d),f=1;c=a-(c-a);0>c?(f=a/(a-c),c=0):c>=this.image.getWidth()&&(f=(this.image.getWidth()-1-a)/(c-a),c=this.image.getWidth()-1);d=Math.floor(b-(d-b)*f);f=1;0>d?(f=b/(b-d),d=0):d>=this.image.getHeight()&&(f=(this.image.getHeight()-1-b)/(d-b),d=this.image.getHeight()-1);c=Math.floor(a+(c-a)*f);e+=this.sizeOfBlackWhiteBlackRun(a,b,c,d);return e-1}sizeOfBlackWhiteBlackRun(a,b,c,d){let e=Math.abs(d-
b)>Math.abs(c-a);if(e){var f=a;a=b;b=f;f=c;c=d;d=f}f=Math.abs(c-a);let g=Math.abs(d-b),h=-f/2,l=a<c?1:-1,r=b<d?1:-1,u=0,v=c+l;for(let c=a,E=b;c!==v;c+=l){if(1===u===this.image.get(e?E:c,e?c:E)){if(2===u)return Ea.distance(c,E,a,b);u++}h+=g;if(0<h){if(E===d)break;E+=r;h-=f}}return 2===u?Ea.distance(c+l,d,a,b):NaN}findAlignmentInRegion(a,b,c,d){let e=Math.floor(d*a);d=Math.max(0,b-e);b=Math.min(this.image.getWidth()-1,b+e);if(b-d<3*a)throw new m("Alignment top exceeds estimated module size.");let f=
Math.max(0,c-e);c=Math.min(this.image.getHeight()-1,c+e);if(c-f<3*a)throw new m("Alignment bottom exceeds estimated module size.");return(new Fb(this.image,d,f,b-d,c-f,a,this.resultPointCallback)).find()}}
class Hb{constructor(){this.decoder=new Ab}getDecoder(){return this.decoder}decode(a,b){void 0!==b&&null!==b&&void 0!==b.get(x.PURE_BARCODE)?(a=Hb.extractPureBits(a.getBlackMatrix()),b=this.decoder.decodeBitMatrix(a,b),a=Hb.NO_POINTS):(a=(new Gb(a.getBlackMatrix())).detect(b),b=this.decoder.decodeBitMatrix(a.getBits(),b),a=a.getPoints());b.getOther()instanceof xb&&b.getOther().applyMirroredCorrection(a);a=new Ha(b.getText(),b.getRawBytes(),void 0,a,t.QR_CODE,void 0);var c=b.getByteSegments();null!==
c&&a.putMetadata(Da.BYTE_SEGMENTS,c);c=b.getECLevel();null!==c&&a.putMetadata(Da.ERROR_CORRECTION_LEVEL,c);b.hasStructuredAppend()&&(a.putMetadata(Da.STRUCTURED_APPEND_SEQUENCE,b.getStructuredAppendSequenceNumber()),a.putMetadata(Da.STRUCTURED_APPEND_PARITY,b.getStructuredAppendParity()));return a}reset(){}static extractPureBits(a){var b=a.getTopLeftOnBit(),c=a.getBottomRightOnBit();if(null===b||null===c)throw new m;let d=this.moduleSize(b,a),e=b[1];var f=c[1];b=b[0];var g=c[0];if(b>=g||e>=f)throw new m;
if(f-e!==g-b&&(g=b+(f-e),g>=a.getWidth()))throw new m;c=Math.round((g-b+1)/d);let h=Math.round((f-e+1)/d);if(0>=c||0>=h)throw new m;if(h!==c)throw new m;var l=Math.floor(d/2);e+=l;b+=l;g=b+Math.floor((c-1)*d)-g;if(0<g){if(g>l)throw new m;b-=g}f=e+Math.floor((h-1)*d)-f;if(0<f){if(f>l)throw new m;e-=f}f=new pa(c,h);for(l=0;l<h;l++){g=e+Math.floor(l*d);for(let e=0;e<c;e++)a.get(b+Math.floor(e*d),g)&&f.set(e,l)}return f}static moduleSize(a,b){let c=b.getHeight(),d=b.getWidth(),e=a[0],f=a[1],g=!0,h=0;
for(;e<d&&f<c;){if(g!==b.get(e,f)){if(5===++h)break;g=!g}e++;f++}if(e===d||f===c)throw new m;return(e-a[0])/7}}Hb.NO_POINTS=[];class Ib extends da{}
class Jb{decode(a,b){this.setHints(b);return this.decodeInternal(a)}decodeWithState(a){null!==this.readers&&void 0!==this.readers||this.setHints(null);return this.decodeInternal(a)}setHints(a){this.hints=a;let b=null!==a&&void 0!==a&&void 0!==a.get(x.TRY_HARDER),c=null===a||void 0===a?null:a.get(x.POSSIBLE_FORMATS),d=[];if(null!==c&&void 0!==c){let e=c.some((a)=>a===t.UPC_A||a===t.UPC_E||a===t.EAN_13||a===t.EAN_8||a===t.CODABAR||a===t.CODE_39||a===t.CODE_93||a===t.CODE_128||a===t.ITF||a===t.RSS_14||
a===t.RSS_EXPANDED);e&&!b&&d.push(new Ua(a));c.includes(t.QR_CODE)&&d.push(new Hb);c.includes(t.DATA_MATRIX)&&d.push(new pb);e&&b&&d.push(new Ua(a))}0===d.length&&(b||d.push(new Ua(a)),d.push(new Hb),d.push(new pb),b&&d.push(new Ua(a)));this.readers=d}reset(){if(null!==this.readers)for(let a of this.readers)a.reset()}decodeInternal(a){if(null===this.readers)throw new Ib("No readers where selected, nothing can be read.");for(let b of this.readers)try{return b.decode(a,this.hints)}catch(c){}throw new m("No MultiFormat Readers were able to detect the code.");
}}class Kb extends za{constructor(a=null,b=500){let c=new Jb;c.setHints(a);super(c,b)}decodeBitmap(a){return this.reader.decodeWithState(a)}}var Lb,Z=Lb||(Lb={});Z[Z.ERROR_CORRECTION=0]="ERROR_CORRECTION";Z[Z.CHARACTER_SET=1]="CHARACTER_SET";Z[Z.DATA_MATRIX_SHAPE=2]="DATA_MATRIX_SHAPE";Z[Z.MIN_SIZE=3]="MIN_SIZE";Z[Z.MAX_SIZE=4]="MAX_SIZE";Z[Z.MARGIN=5]="MARGIN";Z[Z.PDF417_COMPACT=6]="PDF417_COMPACT";Z[Z.PDF417_COMPACTION=7]="PDF417_COMPACTION";Z[Z.PDF417_DIMENSIONS=8]="PDF417_DIMENSIONS";
Z[Z.AZTEC_LAYERS=9]="AZTEC_LAYERS";Z[Z.QR_VERSION=10]="QR_VERSION";Array.from([Int32Array.from([1,1,1,1,1,1,1]),Int32Array.from([1,0,0,0,0,0,1]),Int32Array.from([1,0,1,1,1,0,1]),Int32Array.from([1,0,1,1,1,0,1]),Int32Array.from([1,0,1,1,1,0,1]),Int32Array.from([1,0,0,0,0,0,1]),Int32Array.from([1,1,1,1,1,1,1])]);Array.from([Int32Array.from([1,1,1,1,1]),Int32Array.from([1,0,0,0,1]),Int32Array.from([1,0,1,0,1]),Int32Array.from([1,0,0,0,1]),Int32Array.from([1,1,1,1,1])]);
Array.from([Int32Array.from([-1,-1,-1,-1,-1,-1,-1]),Int32Array.from([6,18,-1,-1,-1,-1,-1]),Int32Array.from([6,22,-1,-1,-1,-1,-1]),Int32Array.from([6,26,-1,-1,-1,-1,-1]),Int32Array.from([6,30,-1,-1,-1,-1,-1]),Int32Array.from([6,34,-1,-1,-1,-1,-1]),Int32Array.from([6,22,38,-1,-1,-1,-1]),Int32Array.from([6,24,42,-1,-1,-1,-1]),Int32Array.from([6,26,46,-1,-1,-1,-1]),Int32Array.from([6,28,50,-1,-1,-1,-1]),Int32Array.from([6,30,54,-1,-1,-1,-1]),Int32Array.from([6,32,58,-1,-1,-1,-1]),Int32Array.from([6,34,
62,-1,-1,-1,-1]),Int32Array.from([6,26,46,66,-1,-1,-1]),Int32Array.from([6,26,48,70,-1,-1,-1]),Int32Array.from([6,26,50,74,-1,-1,-1]),Int32Array.from([6,30,54,78,-1,-1,-1]),Int32Array.from([6,30,56,82,-1,-1,-1]),Int32Array.from([6,30,58,86,-1,-1,-1]),Int32Array.from([6,34,62,90,-1,-1,-1]),Int32Array.from([6,28,50,72,94,-1,-1]),Int32Array.from([6,26,50,74,98,-1,-1]),Int32Array.from([6,30,54,78,102,-1,-1]),Int32Array.from([6,28,54,80,106,-1,-1]),Int32Array.from([6,32,58,84,110,-1,-1]),Int32Array.from([6,
30,58,86,114,-1,-1]),Int32Array.from([6,34,62,90,118,-1,-1]),Int32Array.from([6,26,50,74,98,122,-1]),Int32Array.from([6,30,54,78,102,126,-1]),Int32Array.from([6,26,52,78,104,130,-1]),Int32Array.from([6,30,56,82,108,134,-1]),Int32Array.from([6,34,60,86,112,138,-1]),Int32Array.from([6,30,58,86,114,142,-1]),Int32Array.from([6,34,62,90,118,146,-1]),Int32Array.from([6,30,54,78,102,126,150]),Int32Array.from([6,24,50,76,102,128,154]),Int32Array.from([6,28,54,80,106,132,158]),Int32Array.from([6,32,58,84,
110,136,162]),Int32Array.from([6,26,54,82,110,138,166]),Int32Array.from([6,30,58,86,114,142,170])]);Array.from([Int32Array.from([8,0]),Int32Array.from([8,1]),Int32Array.from([8,2]),Int32Array.from([8,3]),Int32Array.from([8,4]),Int32Array.from([8,5]),Int32Array.from([8,7]),Int32Array.from([8,8]),Int32Array.from([7,8]),Int32Array.from([5,8]),Int32Array.from([4,8]),Int32Array.from([3,8]),Int32Array.from([2,8]),Int32Array.from([1,8]),Int32Array.from([0,8])]);
Int32Array.from([-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,36,-1,-1,-1,37,38,-1,-1,-1,-1,39,40,-1,41,42,43,0,1,2,3,4,5,6,7,8,9,44,-1,-1,-1,-1,-1,-1,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,-1,-1,-1,-1,-1]);O.UTF8.getName();
System.register("QRScannerModule",[],function(a){return{execute:function(){class b{static getBarcdeResolver(){b.browserCodeReader=b.browserCodeReader||new Kb;return b.browserCodeReader}constructor(a,d,e=b.DEFAULT_CANVAS_SIZE){this.$video=a;this.$canvas=document.createElement("canvas");this._onDecode=d;this._paused=this._active=!1;this.$canvas.width=e;this.$canvas.height=e;this._sourceRect={x:0,y:0,width:e,height:e};this.$video.addEventListener("play",(a)=>this._onPlay(a))}static hasCamera(){return navigator.mediaDevices.enumerateDevices().then((a)=>
a.some((a)=>"videoinput"===a.kind)).catch(()=>!1)}start(){if(this._active&&!this._paused)return Promise.resolve();"https:"!==window.location.protocol&&console.warn("The camera stream is only accessible if the page is transferred via https.");console.log("start scanning...");this._active=!0;this._paused=!1;if(document.hidden)return console.warn("camera will be started as soon as tab is in foreground"),Promise.reject();clearTimeout(this._offTimeout);this._offTimeout=null;if(this.$video.srcObject)return this.$video.play(),
Promise.resolve();let a="environment";return this._getCameraStream("environment",!0).catch(()=>{a="user";return this._getCameraStream()}).then((b)=>{this.$video.srcObject=b;this._setVideoMirror(a);this.$video.play()}).catch((a)=>{this._active=!1;throw a;})}_getCameraStream(a,b=!1){let c=[{width:{min:1024}},{width:{min:768}},{}];a&&(b&&(a={exact:a}),c.forEach((b)=>b.facingMode=a));return this._getMatchingCameraStream(c)}_getMatchingCameraStream(a){return 0===a.length?Promise.reject("Camera not found."):
navigator.mediaDevices.getUserMedia({video:a.shift()}).catch(()=>this._getMatchingCameraStream(a))}_setVideoMirror(a){this.$video.style.transform="scaleX("+("user"===a?-1:1)+")"}_onPlay(){this._updateSourceRect();this._scanFrame()}_updateSourceRect(){let a=Math.round(2/3*Math.min(this.$video.videoWidth,this.$video.videoHeight));this._sourceRect.width=this._sourceRect.height=a;this._sourceRect.x=(this.$video.videoWidth-a)/2;this._sourceRect.y=(this.$video.videoHeight-a)/2}_scanFrame(){if(!this._active||
this.$video.paused||this.$video.ended)return!1;requestAnimationFrame(()=>{b.scanImage(this.$video,this._sourceRect,null,this.$canvas,!0).then((a)=>{this._onDecode(a)}).catch(()=>{}).then(()=>{setTimeout(()=>{this._scanFrame()},2E3)})})}destroy(){this.$video.removeEventListener("play",this._onPlay);this.$video.pause();setTimeout(()=>{let a=this.$video.srcObject&&this.$video.srcObject.getTracks()[0];a&&(a.stop(),this.$video.srcObject=null)},300);this._active=!1}stop(){this.destroy()}static scanImage(a){return new Promise((c,
e)=>{b._loadImage(a).then((a)=>{a=b.getBarcdeResolver().decodeFromImageElement(a);setTimeout(()=>{e("timeout",3E3)});a.then((a)=>{c(a);console.log(a)}).catch((a)=>{e();console.log(a)})}).catch((a)=>{e(a)})})}static _loadImage(a){if(a instanceof HTMLCanvasElement||a instanceof HTMLVideoElement){var b=document.createElement("canvas");b.width=Math.max(a.width,a.videoWidth);b.height=Math.max(a.height,a.videoHeight);b.getContext("2d").drawImage(a,0,0,b.width,b.height);a=new Image;a.src=b.toDataURL();return Promise.resolve(a)}if(!(a instanceof
Image))return a instanceof File||a instanceof URL||"string"===typeof a?(b=new Image,b.src=a instanceof File?URL.createObjectURL(a):a,Promise.resolve(b)):Promise.reject("Unsupported image type.")}static _awaitImageLoad(a){return new Promise((b,c)=>{if(a.complete&&0!==a.naturalWidth)b();else{let d,e;d=()=>{a.removeEventListener("load",d);a.removeEventListener("error",e);b()};e=()=>{a.removeEventListener("load",d);a.removeEventListener("error",e);c("Image load error")};a.addEventListener("load",d);a.addEventListener("error",
e)}})}}b.DEFAULT_CANVAS_SIZE=400;b.WORKER_PATH="qr-scanner-worker.min.js";a("QrScanner",b)}}});
//# sourceMappingURL=qr-scanner.min.js.map
